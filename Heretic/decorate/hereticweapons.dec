// ****************
// ***** AMMO *****
// ****************


ACTOR GoldWandAmmoNew : GoldWandAmmo { }
ACTOR GoldWandHeftyNew : GoldWandHefty { }
ACTOR CrossbowAmmoNew : CrossbowAmmo { }
ACTOR CrossbowHeftyNew : CrossbowHefty { }
ACTOR BlasterAmmoNew : BlasterAmmo { }
ACTOR BlasterHeftyNew : BlasterHefty { }
ACTOR PhoenixRodAmmoNew : PhoenixRodAmmo { }
ACTOR PhoenixRodHeftyNew : PhoenixRodHefty { }
ACTOR MaceAmmoNew : MaceAmmo { }
ACTOR MaceHeftyNew : MaceHefty { }

// **************************
// ***** AMMO REPLACERS *****
// **************************

ACTOR GoldWandAmmoSpawner : GoldWandAmmo replaces GoldWandAmmo
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("GoldWandAmmoNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("GoldWandAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("GoldWandAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrow",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   25) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR GoldWandHeftySpawner : GoldWandHefty replaces GoldWandHefty
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("GoldWandHeftyNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("GoldWandHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("GoldWandHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrowQuiver",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana2",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR CrossbowAmmoSpawner : CrossbowAmmo replaces CrossbowAmmo
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("CrossbowAmmoNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("CrossbowAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("CrossbowAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=  100) { A_SpawnItemEx("DiarisArrow",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   25) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR CrossbowHeftySpawner : CrossbowHefty replaces CrossbowHefty
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("CrossbowHeftyNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("CrossbowHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("CrossbowHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=  100) { A_SpawnItemEx("DiarisArrowQuiver",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana2",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR BlasterAmmoSpawner : BlasterAmmo replaces BlasterAmmo
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("BlasterAmmoNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("BlasterAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("BlasterAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrow",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   25) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR BlasterHeftySpawner : BlasterHefty replaces BlasterHefty
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("BlasterHeftyNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("BlasterHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("BlasterHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrowQuiver",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana2",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR PhoenixRodAmmoSpawner : PhoenixRodAmmo replaces PhoenixRodAmmo
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("PhoenixRodAmmoNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("PhoenixRodAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("PhoenixRodAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=  100) { A_SpawnItemEx("DiarisArrow",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   25) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR PhoenixRodHeftySpawner : PhoenixRodHefty replaces PhoenixRodHefty
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("PhoenixRodHeftyNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("PhoenixRodHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("PhoenixRodHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=  100) { A_SpawnItemEx("DiarisArrowQuiver",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana2",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR MaceAmmoSpawner : MaceAmmo replaces MaceAmmo
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("MaceAmmoNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("MaceAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("MaceAmmoNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrow",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   25) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

ACTOR MaceHeftySpawner : MaceHefty replaces MaceHefty
{
  States
  {
  Spawn:
    TNT1 A 0 NoDelay
	{
     if (Random(1,1000) <= 1000) { A_SpawnItemEx("MaceHeftyNew",0,0,0,0,0,0); }
	 if (Random(1,1000) <=  200) { A_SpawnItemEx("MaceHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   75) { A_SpawnItemEx("MaceHeftyNew",random(-8,8),random(-8,8),0,random(-8,8),random(-8,8),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("DiarisArrowQuiver",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=  125) { A_SpawnItemEx("DoomSpellMana2",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	 if (Random(1,1000) <=   50) { A_SpawnItemEx("RandomMagicSpawner",random(-4,4),random(-4,4),0,random(-4,4),random(-4,4),0); }
	}
    TNT1 A 0
    Stop
  }
}

// *******************
// ***** WEAPONS *****
// *******************
ACTOR GoldWandPuff1New : GoldWandPuff1 { DamageType "Magic" }
ACTOR GoldWandPuff2New : GoldWandPuff2 { DamageType "Magic" }
ACTOR GoldWandFX1New : GoldWandFX1 
{ 
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",41)) // 2
 DamageType "Magic" 
}
ACTOR GoldWandFX2New : GoldWandFX2 
{ 
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",42)) // 1
 DamageType "Magic" 
}

ACTOR GoldWandNew : GoldWand replaces GoldWand
{
  Weapon.AmmoType1 "GoldWandAmmo"
  Weapon.AmmoType2 "GoldWandAmmo"
  Weapon.AmmoUse1 1  
  Weapon.AmmoUse2 1  
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    GWAN A 0 NoDelay
	{
	 if (CountInv("GoldWandNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualGoldWandNew");
	  A_FadeOut(1,1);
	 }
	}
    GWAN A 1
    Loop
  Despawn:
    GWAN A 0
    Stop
  Ready:
    GWND A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    GWND A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    GWND A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    GWND B 3 
    GWND C 5 // A_FireGoldWandPL1
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
	 }
	}
    GWND D 3
    GWND D 0 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    GWND B 3 
    GWND C 4 // A_FireGoldWandPL2
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
	 }
	}
    GWND D 3
    GWND D 0 A_ReFire
    Goto Ready
  }
}

ACTOR DualGoldWandNew : GoldWandNew
{
  Weapon.AmmoType1 "GoldWandAmmo"
  Weapon.AmmoType2 "GoldWandAmmo"
  Weapon.AmmoUse1 1  
  Weapon.AmmoUse2 1  
  Tag "Dual Elven Wands"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    GWAN A -1
    Stop
  Ready:
    GWN2 A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    GWN2 A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    GWN2 A 1 { A_Raise; A_Raise; }
    Loop
  Fire: // 11 Frames
    GWN2 B 3 
    GWN2 CD 5 // A_FireGoldWandPL1
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",29,1)),"GoldWandPuff1New",1); A_PlaySound("weapons/wandhit",1);
	 }
	}
    GWN2 E 3

    GWN2 E 0 A_ReFire
    Goto Ready
  AltFire: // 10 Frames
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    GWN2 B 3 
    GWN2 CD 4 // A_FireGoldWandPL2
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle-15);
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,0); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_SetAngle(angle-5.625);
 	  A_FireCustomMissile("GoldWandFX2New",0,0);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
      A_SetAngle(angle+2.8125);
 	  A_FireBullets(0,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",30,1)),"GoldWandPuff2New",0);
 	  A_FireCustomMissile("GoldWandFX2New",0,1); A_PlaySound("weapons/wandhit",1);
      A_SetAngle(angle-5.625);
	 }
	}
    GWN2 E 3

    GWN2 E 0 A_ReFire
    Goto Ready
  }
}

ACTOR CrossbowFX1New : CrossbowFX1 
{
  DamageType "Magic"
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",21)) // 10
  Speed 30
  Radius 11
  Height 8
  Projectile
  RenderStyle Add
  SeeSound "weapons/bowshoot"
  DeathSound "weapons/bowhit"
  Obituary "$OB_MPCROSSBOW"
  States
  {
  Spawn:
    FX03 B 0 NoDelay
  Idle:
    FX03 B 1 Bright
    Loop
  Death:
    FX03 HIJ 8 Bright
    Stop
  }
}
ACTOR CrossbowFX2New : CrossbowFX2
{
  DamageType "Magic" 
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",22)) // 6
  Speed 32
  Obituary "$OB_MPPCROSSBOW"
  States
  {
  Spawn:
    FX03 B 0 NoDelay
  Idle:
    FX03 B 1 Bright A_SpawnItemEx("CrossbowFX4", random2[BoltSpark]()*0.015625, random2[BoltSpark]()*0.015625,
                                  0, 0, 0, 0, 0, SXF_ABSOLUTEPOSITION, 50)
    Loop
  }
}
ACTOR CrossbowFX3New : CrossbowFX3
{
  DamageType "Magic" 
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",23)) // 2
  Speed 20
  SeeSound ""
  -NOBLOCKMAP
  +WINDTHRUST
  +THRUGHOST
  States
  {
  Spawn:
    FX03 A 0 NoDelay
  Idle:
    FX03 A 1 Bright
    Loop
  Death:
    FX03 CDE 8 Bright
    Stop
  }
}

ACTOR CrossbowNew : Crossbow replaces Crossbow
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 1
  Weapon.AmmoType1 "CrossbowAmmo"
  Weapon.AmmoType2 "CrossbowAmmo"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBOW A 0 NoDelay
	{
	 if (random(1,10) == 25)
	 {
	  A_SpawnItemEx("DiarisLongBow");
	  A_FadeOut(1,1);
	 }
	}
    WBOW A 0
	{
	 if (random(1,10) == 10)
	 {
	  A_SpawnItemEx("SuperCrossbowNew");
	  A_FadeOut(1,1);
	 }
	}
  Idle:
    WBOW A 0
	{
	 if (CountInv("CrossbowNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualCrossbowNew");
	  A_FadeOut(1,1);
	 }
	}
    WBOW A 1
    Loop
  Ready:
    CRBW AAAAAABBBBBBCCCCCC 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    CRBW A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    CRBW A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    CRBW D 6 // A_FireCrossbowPL1
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX1New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5, 0,  2, 3);
	 }
	}
    CRBW EFGH 3
    CRBW AB 4
    CRBW C 5 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    CRBW D 5 // A_FireCrossbowPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0, 0,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX2New",    0, 1,  0, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5, 0, -2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5, 0,  2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9, 0, -4, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9, 0,  4, 3);
	 }
	}
    CRBW E 3
    CRBW F 2
    CRBW G 3
    CRBW H 2
    CRBW A 3
    CRBW B 3
    CRBW C 4 A_ReFire
    Goto Ready
  }
}

ACTOR DualCrossbowNew : CrossbowNew
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 1
  Weapon.AmmoType1 "CrossbowAmmo"
  Weapon.AmmoType2 "CrossbowAmmo"
  Tag "Dual Ethereal Crossbows"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBOW A -1
    Stop
  Ready:
    CRBD AAAAAABBBBBBCCCCCC 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    CRBD A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    CRBD A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    CRBD D 6 // A_FireCrossbowPL1
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX1New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5-4, 0,  2-2, 3);
	 }
	}
    CRBD E 6 // A_FireCrossbowPL1
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX1New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX3New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",  4.5+4, 0,  2+2, 3);
	 }
	}
    CRBD FGH 3
    CRBD AB 4
    CRBD C 5 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    CRBD D 5 // A_FireCrossbowPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 0,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX2New",    0-4, 1,  0-2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5-4, 0, -2-2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5-4, 0,  2-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9-4, 0, -4-2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9-4, 0,  4-2, 3);
	 }
	}
    CRBD E 5 // A_FireCrossbowPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      A_SetAngle(angle-15);
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 0,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile ("CrossbowFX2New",    0+4, 1,  0+2, 3);
      A_FireCustomMissile ("CrossbowFX2New", -4.5+4, 0, -2+2, 3);
      A_FireCustomMissile ("CrossbowFX2New",  4.5+4, 0,  2+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",   -9+4, 0, -4+2, 3);
      A_FireCustomMissile ("CrossbowFX3New",    9+4, 0,  4+2, 3);
	 }
	}
    CRBD F 3
    CRBD G 2
    CRBD H 3
    CRBD A 3
    CRBD B 3
    CRBD C 4 A_ReFire
    Goto Ready
  }
}

ACTOR RipperNew
{
  DamageType "Magic" 
  Radius 8
  Height 6
  Speed 14
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",24)) // 1
  Projectile
  +RIPPER
  DeathSound "weapons/blasterpowhit"
  Obituary "$OB_MPPBLASTER"
  States
  {
  Spawn:
    FX18 M 4
    FX18 N 5
    Loop
  Death:
    FX18 OPQRS 4 Bright
    Stop
  }
}
ACTOR BlasterPuffNew : BlasterPuff 
{ 
 DamageType "Magic" 
}
ACTOR BlasterFX1New : BlasterFX1 
{
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",28)) //2
  DamageType "Magic"
  States
  {
  Spawn:
    ACLO E 200
    Loop
  Death:
    FX18 A 3 Bright // A_SpawnRippers
	{
     A_CustomMissile("RipperNew",0,0,  0,6);
     A_CustomMissile("RipperNew",0,0, 45,6);
     A_CustomMissile("RipperNew",0,0, 90,6);
     A_CustomMissile("RipperNew",0,0,135,6);
     A_CustomMissile("RipperNew",0,0,180,6);
     A_CustomMissile("RipperNew",0,0,225,6);
     A_CustomMissile("RipperNew",0,0,270,6);
     A_CustomMissile("RipperNew",0,0,315,6);
	}
    FX18 B 3 Bright
    FX18 CDEFG 4 Bright
    Stop
  }
}

ACTOR DragonClawNew : Blaster replaces Blaster
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "BlasterAmmo"
  Weapon.AmmoType2 "BlasterAmmo"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBLS A 0 NoDelay
	{
	 if (CountInv("DragonClawNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualDragonClawNew");
	  A_FadeOut(1,1);
	 }
	}
    WBLS A 1
    Loop
  Ready:
    FBLS A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    FBLS A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    FBLS A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    FBLS BC 3
  Hold:
    FBLS D 2 // A_FireBlasterPL1
    {
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
	 }
	}
    FBLS CB 2
    FBLS A 0 A_ReFire
    Goto Ready
  AltFire:
    FBLS BC 0
  AltHold:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    FBLS D 3 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/blastershoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      A_SetAngle(angle-15);
  	  A_FireCustomMissile("BlasterFX1New",0,1);
      A_SetAngle(angle-15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
  	  A_FireCustomMissile("BlasterFX1New",0,1);
	 }
	}
    FBLS CB 4
    FBLS A 0 A_ReFire
    Goto Ready
  }
}

ACTOR DualDragonClawNew : DragonClawNew
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "BlasterAmmo"
  Weapon.AmmoType2 "BlasterAmmo"
  Tag "Dual Dragon Claws"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBLS A -1
    Stop
  Ready:
    FDBL A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    FDBL A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    FDBL A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    FDBL BC 3
  Hold:
    FDBL DE 2 // A_FireBlasterPL1
    {
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/blastershoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle-15);
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",0); A_PlaySound("weapons/blastershoot",1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireBullets(5.625,0,1,(ACS_NamedExecuteWithResult("GetPlayerATKDMG",27,1)),"BlasterPuffNew",1); A_PlaySound("weapons/blastershoot",1);
	 }
	}
    FDBL FG 2
    FDBL A 0 A_ReFire
    Goto Ready
  AltFire:
    FDBL BC 0
  AltHold:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    FDBL DE 3 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/blastershoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      A_SetAngle(angle-15);
  	  A_FireCustomMissile("BlasterFX1New",0,1);
      A_SetAngle(angle-15);
  	  A_FireCustomMissile("BlasterFX1New",0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
  	  A_FireCustomMissile("BlasterFX1New",0,1);
	 }
	}
    FDBL FG 4
    FDBL A 0 A_ReFire
    Goto Ready
  }
}

ACTOR HornRodFX1New : HornRodFX1 
{ 
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",31)) //2
  DamageType "Magic" 
  SeeSound ""
  States
  {
  Idle:
    FX00 A 0 NoDelay A_Jump(128,2)
  Spawn:
    FX00 AB 6 Bright
    Loop
  }	
}
ACTOR HornRodFX2New : HornRodFX2 
{ 
  var int user_fuse;
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",32)) //2
  DamageType "Acid"
  DamageType "Magic" 
  +SEEKERMISSILE
  States
  {
  Spawn:
    FX00 C 0 Bright NoDelay A_ScaleVelocity(1.0625)
    FX00 C 0 Bright A_SetUserVar("user_fuse",random(120,160))
    FX00 C 3 Bright
    FX00 D 3 Bright A_SeekerMissile(10,30,SMF_LOOK|SMF_PRECISE|SMF_CURSPEED,96,32)
    FX00 E 3 Bright
    FX00 F 3 Bright A_SeekerMissile(10,30,SMF_LOOK|SMF_PRECISE|SMF_CURSPEED,96,32)
    Loop
  Death:
    FX00 H 5 Bright // A_AddPlayerRain
    FX00 I 5 Bright A_Explode(16+random(-9,9),32,0)
    FX00 J 4 Bright
    FX00 KLM 3 Bright
    FX00 G 1 A_HideInCeiling
//  Wait
  RainLoop:
    FX00 G 0 // A_SkullRodStorm
	{
     A_SpawnItemEx("RainPillarNew",random(-64,64),random(-64,64),-4,random(-0.25,0.25),random(-0.25,0.25),random(-14,-10),0,SXF_NOCHECKPOSITION,16);
     A_SpawnItemEx("RainPillarNew",random(-64,64),random(-64,64),-4,random(-0.25,0.25),random(-0.25,0.25),random(-14,-10),0,SXF_NOCHECKPOSITION,248);
     A_SetUserVar("user_fuse",user_fuse-1);
    }
    FX00 G 1 A_JumpIf(user_fuse<=0,"End")
    Loop
  End:
    TNT1 A 0 A_FadeOut(1)
    stop
  }
}
ACTOR RainPillarNew : RainPillar replaces RainPillar 
{
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",43)) //5
 DamageType "Magic" 
}

ACTOR HellStaffNew : SkullRod replaces SkullRod
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "SkullRodAmmo"
  Weapon.AmmoType2 "SkullRodAmmo"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WSKL A 0 NoDelay
	{
	 if (CountInv("HellStaffNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualHellStaffNew");
	  A_FadeOut(1,1);
	 }
	}
    WSKL A 1
    Loop
  Ready:
    HROD A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    HROD A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    HROD A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    HROD AB 4 // A_FireSkullRodPL1
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/hornrodshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("HornRodFX1New",0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("HornRodFX1New",0,1);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("HornRodFX1New",0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("HornRodFX1New",0,1);
	 }
	}
    HROD B 0 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    HROD C 2
    HROD D 3
    HROD E 2
    HROD F 3
    HROD G 4 // A_FireSkullRodPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/hornrodpowshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("HornRodFX2New",0,1,0,0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("HornRodFX2New",0,1,0,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("HornRodFX2New",0,0,0,0,1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("HornRodFX2New",0,1,0,0,1);
	 }
	}
    HROD F 2
    HROD E 3
    HROD D 2
    HROD C 2 A_ReFire
    Goto Ready
  }
}

ACTOR DualHellStaffNew : HellStaffNew
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "SkullRodAmmo"
  Weapon.AmmoType2 "SkullRodAmmo"
  Tag "Dual HellStaves"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WSKL A -1
    Stop
  Ready:
    DHRD A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    DHRD A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    DHRD A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    DHRD AB 4 // A_FireSkullRodPL1
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/hornrodshoot",1);
     A_PlaySound("weapons/hornrodshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("HornRodFX1New",3,1,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,1,-3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("HornRodFX1New",3,1,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,1,-3);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("HornRodFX1New",3,0,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,0,-3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("HornRodFX1New",3,1,3);
 	  A_FireCustomMissile("HornRodFX1New",-3,1,-3);
	 }
	}
    DHRD B 0 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    DHRD C 2
    DHRD D 3
    DHRD E 2
    DHRD F 3
    DHRD G 4 // A_FireSkullRodPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/hornrodpowshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("HornRodFX2New",3,1,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,1,-3,0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("HornRodFX2New",3,1,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,1,-3,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("HornRodFX2New",3,0,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,0,-3,0,1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("HornRodFX2New",3,1,3,0,1);
	  A_FireCustomMissile("HornRodFX2New",-3,1,-3,0,1);
	 }
	}
    DHRD F 2
    DHRD E 3
    DHRD D 2
    DHRD C 2 A_ReFire
    Goto Ready
  }
}

ACTOR PhoenixFX1NoAOE : PhoenixFX1 // Spread shots of Phoenix Rod, cannot deal self-AOE [necessary due to how Spreader Aura spreads out extra shots]
{
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",33)) //2
  DamageType "Magic"
  DamageType "Fire"
  States
  {
  Death:
    FX08 A 6 Bright A_Explode(128,128,0)
    FX08 BC 5 Bright
    FX08 DEFGH 4 Bright
    Stop
  }
}

ACTOR PhoenixFX1New : PhoenixFX1
{
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",33)) //2
  DamageType "Magic"
  DamageType "Fire"
}
ACTOR PhoenixFX2New : PhoenixFX2
{
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",34)) //2
  DamageType "Magic"
  DamageType "Fire"
}

ACTOR PhoenixRodNew : PhoenixRod replaces PhoenixRod
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 1
  Weapon.AmmoType1 "PhoenixRodAmmo"
  Weapon.AmmoType2 "PhoenixRodAmmo"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WPHX A 0 NoDelay
	{
	 if (CountInv("PhoenixRodNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualPhoenixRodNew");
	  A_FadeOut(1,1);
	 }
	}
    WPHX A 1
    Loop
  Ready:
    PHNX A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    PHNX A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    PHNX A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    PHNX B 5
    PHNX C 7
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
     if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX1New",0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX1New",0,1);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("PhoenixFX1New",0,1);
	 }
     A_Recoil(4);
	}
    PHNX DB 4
    PHNX B 0 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    PHNX B 3 // A_InitPhoenixPL2
	{
     ACS_NamedExecuteWithResult("FlameCount",0,350);
	}
  AltHold:
    PHNX C 1 // A_FirePhoenixPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("PhoenixFX2New",random(-2,2),0,random(-2,2),0,1,2);
	 }
	 A_PlaySound("weapons/phoenixpowshoot",1,1.0,1);
     ACS_NamedExecuteWithResult("FlameCount",1,-1);
	}
    PHNX B 0 A_JumpIf(ACS_NamedExecuteWithResult("FlameCount",2) < 1, "AltPowerdown")
    PHNX B 4 A_ReFire
  AltPowerdown:
    PHNX B 4 // A_ShutdownPhoenixPL2
	{
	 A_TakeInventory("PhoenixRodAmmo",1,TIF_NOTAKEINFINITE,AAPTR_PLAYER1);
     ACS_NamedExecuteWithResult("FlameCount",0,350);
	 A_StopSound(1);
	}
    Goto Ready
  }
}

ACTOR DualPhoenixRodNew : PhoenixRodNew
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 1
  Weapon.AmmoType1 "PhoenixRodAmmo"
  Weapon.AmmoType2 "PhoenixRodAmmo"
  Tag "Dual Phoenix Rods"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WPHX A -1
    Stop
  Ready:
    PHND A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    PHND A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    PHND A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    PHND B 5
    PHND C 7
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
     if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX1New",3,1,3);
 	  A_FireCustomMissile("PhoenixFX1New",-3,1,-3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX1New",3,1,3);
 	  A_FireCustomMissile("PhoenixFX1New",-3,1,-3);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",3,0,3);
 	  A_FireCustomMissile("PhoenixFX1NoAOE",-3,0,-3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("PhoenixFX1New",3,1,3);
 	  A_FireCustomMissile("PhoenixFX1New",-3,1,-3);
	 }
     A_Recoil(9);
	}
    PHND DB 4
    PHND B 0 A_ReFire
    Goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    PHND B 3 // A_InitPhoenixPL2
	{
     ACS_NamedExecuteWithResult("FlameCount",0,350);
	}
  AltHold:
    PHND C 1 // A_FirePhoenixPL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      A_SetAngle(angle-15);
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
      A_SetAngle(angle+15);
	 }
	 else
	 {
 	  A_FireCustomMissile("PhoenixFX2New",random(-5,-1),0,random(-5,1),0,1,2);
 	  A_FireCustomMissile("PhoenixFX2New",random(1,5),0,random(1,5),0,1,2);
	 }
	 A_PlaySound("weapons/phoenixpowshoot",1,1.0,1);
     ACS_NamedExecuteWithResult("FlameCount",1,-1);
	}
    PHND B 0 A_JumpIf(ACS_NamedExecuteWithResult("FlameCount",2) < 1, "AltPowerdown")
    PHND B 4 A_ReFire
  AltPowerdown:
    PHND B 4 // A_ShutdownPhoenixPL2
	{
	 A_TakeInventory("PhoenixRodAmmo",2,TIF_NOTAKEINFINITE,AAPTR_PLAYER1);
     ACS_NamedExecuteWithResult("FlameCount",0,350);
	 A_StopSound(1);
	}
    Goto Ready
  }
}

ACTOR MaceFX1New : MaceFX1
{
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",35)) //2
  DamageType "Magic"
  SeeSound ""
  var int user_special1;
  States
  {
  Spawn:
    FX02 A 0 NoDelay A_SetUserVar("user_special1",16)
  Idle:
    FX02 AB 4 //A_MacePL1Check
	{
     if (user_special1 > 0)
	 {
	  A_SetUserVar("user_special1",user_special1-4);
	 }
	 else
     if (user_special1 == 0)
	 {
	  A_SetUserVar("user_special1",-4); A_Recoil(-7); A_ChangeFlag("NOGRAVITY",0); A_SetGravity(0.125); A_SetFloatSpeed(2); 
	 }
	 else
     if (user_special1 <= -4)
	 {
	  A_ChangeFlag("NOGRAVITY",0); A_SetGravity(0.125); A_SetFloatSpeed(2); 
	 }
	}
    Loop
  Death:
    FX02 F 4 Bright A_MaceBallImpact
    FX02 GHIJ 4 Bright
    Stop
  }
}
ACTOR MaceFX2New : MaceFX2 
{ 
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",36)) //2
 DamageType "Magic" 
}
ACTOR MaceFX3New : MaceFX3
{ 
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",37)) //2
 DamageType "Magic" 
}
ACTOR MaceFX4New : MaceFX4
{ 
 Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",38)) //2
 DamageType "Magic" 
}

ACTOR MaceSpawnerNew : MaceSpawner replaces MaceSpawner
{
  +NOSECTOR
  +NOBLOCKMAP
  States
  {
  Spawn:
    TNT1 A 1
    TNT1 A -1 A_SpawnItemEx("FiremaceNew")
    Stop
  }
}

ACTOR FiremaceNew : Mace replaces Mace
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "MaceAmmo"
  Weapon.AmmoType2 "MaceAmmo"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WMCE A 0 NoDelay
	{
	 if (CountInv("FiremaceNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualFiremaceNew");
	  A_FadeOut(1,1);
	 }
	}
    WMCE A 1
    Loop
  Ready:
    MACE A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    MACE A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    MACE A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    MACE B 4
  Hold:
    MACE CDEF 3
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/maceshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),1,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,1,0,0,0,2); }
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      A_SetAngle(angle-15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),1,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,1,0,0,0,2); }
      A_SetAngle(angle-15);
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),0,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,0,0,0,0,2); }
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  if (random(1,100) <= 89) { A_FireCustomMissile("MaceFX1New",random(-4.21875,4.21875),1,0,0,0,0); } else { A_FireCustomMissile("MaceFX2New",0,1,0,0,0,2); }
	 }
	}
    MACE C 4 A_ReFire
    MACE DEFB 4
    Goto Ready
  AltFire:
  AltHold:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    MACE B 4
    MACE D 4 // A_FireMacePL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/maceshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("MaceFX4New",0,1,0,0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("MaceFX4New",0,1,0,0,1);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("MaceFX4New",0,0,0,0,1);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("MaceFX4New",0,1,0,0,1);
	 }
	}
    MACE B 4
    MACE A 8 A_ReFire
    Goto Ready
  }
}

ACTOR DualFiremaceNew : FiremaceNew
{
  Weapon.AmmoUse1 1
  Weapon.AmmoUse2 5
  Weapon.AmmoType1 "MaceAmmo"
  Weapon.AmmoType2 "MaceAmmo"
  Tag "Dual Firemaces"

  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WMCE A -1
    Stop
  Ready:
    DMAC A 1 A_WeaponReady(WRF_ALLOWUSER1)
    Loop
  Deselect:
    DMAC A 1 { A_Lower; A_Lower; }
    Loop
  Select:
    DMAC A 1 { A_Raise; A_Raise; }
    Loop
  Fire:
    DMAC B 4
  Hold:
    DMAC CDEF 3
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/maceshoot",1);
     A_PlaySound("weapons/maceshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),1,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),1,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),1,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),1,random(0,-2),0,0,2); 
	  }
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      A_SetAngle(angle-15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),1,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),1,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),1,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),1,random(0,-2),0,0,2); 
	  }
      A_SetAngle(angle-15);
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),0,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),0,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),0,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),0,random(0,-2),0,0,2); 
	  }
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  if (random(1,100) <= 89) 
	  { 
	   A_FireCustomMissile("MaceFX1New",random(-6.328125,2.109375),1,random(-3,1),0,0,0); 
	   A_FireCustomMissile("MaceFX1New",random(-2.109375,6.328125),1,random(-1,3),0,0,0); 
	  } 
	  else 
	  { 
	   A_FireCustomMissile("MaceFX2New",random(2,0),1,random(2,0),0,0,2); 
	   A_FireCustomMissile("MaceFX2New",random(0,-2),1,random(0,-2),0,0,2); 
	  }
	 }
	}
    DMAC C 4 A_ReFire
    DMAC DEFB 4
    Goto Ready
  AltFire:
  AltHold:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    DMAC B 4
    DMAC D 4 // A_FireMacePL2
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/maceshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("MaceFX4New",random(4,0),1,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),1,random(0,-4),0,0,1); 
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      // Reset
      A_SetAngle(angle+15);
     }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      A_SetAngle(angle-15);
      A_FireCustomMissile("MaceFX4New",random(4,0),1,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),1,random(0,-4),0,0,1); 
      A_SetAngle(angle-15);
      A_FireCustomMissile("MaceFX4New",random(4,0),0,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),0,random(0,-4),0,0,1); 
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("MaceFX4New",random(4,0),1,random(4,0),0,0,1); 
      A_FireCustomMissile("MaceFX4New",random(0,-4),1,random(0,-4),0,0,1); 
	 }
	}
    DMAC B 4
    DMAC A 8 A_ReFire
    Goto Ready
  }
}

actor SuperCrossbowNew : Weapon 25102
{
  spawnid 33
  obituary "%o was splattered by %k's super crossbow."
  radius 20
  height 16
  attacksound "weapons/sshotf"
  inventory.pickupmessage "SUPER ETHEREAL CROSSBOW"
  weapon.selectionorder 400
  Weapon.AmmoType1 "CrossbowAmmo"
  Weapon.AmmoType2 "CrossbowAmmo"
  weapon.kickback 100
  weapon.AmmoUse1 2
  weapon.AmmoUse2 2
  weapon.AmmoGive 8
  Tag "Super Ethereal Crossbow"
  states
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBOW B 0 NoDelay
	{
	 if (CountInv("SuperCrossbowNew",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualSuperCrossbowNew");
	  A_FadeOut(1,1);
	 }
	}
    WBOW B 1
    Loop
  Ready: 
    CRB2 ABC 6 A_WeaponReady(WRF_ALLOWUSER1)
    loop
  Deselect:
    CRB2 ABC 1 { A_Lower; A_Lower; }
    loop
  Select:
    CRB2 ABC 1 { A_Raise; A_Raise; }
    loop
  Fire:
    CRB2 A 3
	CRB2 D 4
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/bowshoot",1);
     A_PlaySound("weapons/bowshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX1New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX1New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX3New", 4,0,-14,  0);
      A_FireCustomMissile("CrossbowFX3New",-4,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0,  0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0,  0,-10);
	 }
	}
    CRB2 E 10
    CRB2 F 12 
    CRB2 G 9 
    CRB2 H 1 
    CRB2 H 5 A_ReFire
    goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
    CRB2 A 3
    CRB2 D 5
	{
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");

	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0,0,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX2New", 0,2,  7,  0);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New", 1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 0,0, -7,  0);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0,  5);
      A_FireCustomMissile("CrossbowFX2New",-1,0,  0, -5);
      A_FireCustomMissile("CrossbowFX2New", 2,0,-14,  0);
      A_FireCustomMissile("CrossbowFX2New",-2,0, 14,  0);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0, 10);
      A_FireCustomMissile("CrossbowFX3New", 2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New",-2,0, 0,-10);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0,  5);
      A_FireCustomMissile("CrossbowFX3New", 1,0, 0, -5);
      A_FireCustomMissile("CrossbowFX3New",-1,0, 0, -5);
	 }
	}
    CRB2 E 6
    CRB2 F 6 
    CRB2 G 5 
    CRB2 H 3 A_ReFire
    goto Ready
  }
}

actor DualSuperCrossbowNew : SuperCrossbowNew
{
  spawnid 33
  obituary "%o was splattered by %k's super crossbows."
  radius 20
  height 16
  attacksound "weapons/sshotf"
  inventory.pickupmessage "SUPER ETHEREAL CROSSBOW"
  weapon.selectionorder 400
  Weapon.AmmoType1 "CrossbowAmmo"
  Weapon.AmmoType2 "CrossbowAmmo"
  weapon.kickback 100
  weapon.AmmoUse1 2
  weapon.AmmoUse2 2
  weapon.AmmoGive 8
  Tag "Dual Super Ethereal Crossbows"
  states
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    WBOW B -1
    stop
  Ready: 
    SCRD ABC 6 A_WeaponReady(WRF_ALLOWUSER1)
    loop
  Deselect:
    SCRD ABC 1 { A_Lower; A_Lower; }
    loop
  Select:
    SCRD ABC 1 { A_Raise; A_Raise; }
    loop
  Fire:
    SCRD A 3
	SCRD D 4
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/bowshoot",1);
     A_PlaySound("weapons/bowshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX1New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
	 }
	}
	SCRD E 4
    {
     ACS_NamedExecuteAlways("StartTensionCountDown");
     A_PlaySound("weapons/bowshoot",1);
     A_PlaySound("weapons/bowshoot",1);
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX1New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX1New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 4+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX3New",-4+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
	 }
	}
    SCRD F 10
    SCRD G 12 
    SCRD H 6 
    SCRD H 3 A_ReFire
    goto Ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
    SCRD A 3
    SCRD D 5
	{
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX2New", 0-6,2,  7-3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0-6,0, -7-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2-6,0,-14-3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2-6,0, 14-3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2-6,0,  0-3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1-6,0,  0-3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1-6,0,  0-3, -5);
	 }
	}
    SCRD E 5
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 A_PlaySound("weapons/bowshoot");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      A_SetAngle(angle-15);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("CrossbowFX2New", 0+6,2,  7+3,  0);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 0+6,0, -7+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX2New",-1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX2New", 2+6,0,-14+3,  0);
      A_FireCustomMissile("CrossbowFX2New",-2+6,0, 14+3,  0);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3, 10);
      A_FireCustomMissile("CrossbowFX3New", 2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New",-2+6,0,  0+3,-10);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3,  5);
      A_FireCustomMissile("CrossbowFX3New", 1+6,0,  0+3, -5);
      A_FireCustomMissile("CrossbowFX3New",-1+6,0,  0+3, -5);
	 }
	}
    SCRD F 6
    SCRD G 6 
    SCRD H 3 
    SCRD H 2 A_ReFire
    goto Ready
  }
}


ACTOR Sorcerer2FX1New : Sorcerer2FX1 replaces Sorcerer2FX1
{
  Radius 10
  Height 6
  Speed 20
  FastSpeed 28
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",39)) //20
  DamageType "Thunder"
  DamageType "Magic"
  Projectile
  -ACTIVATEIMPACT
  -ACTIVATEPCROSS
  RenderStyle Add

  States
  {
  Spawn:
    FX16 ABC 3 Bright A_BlueSpark
    Loop
  Death:
    FX16 G 5 Bright A_Explode(random(104,152),128,0)
    FX16 HIJKL 5 Bright
    Stop
  }
}

actor Sorcerer2FX3
{
  Radius 10
  Height 6
  Speed 6
  Damage (ACS_NamedExecuteWithResult("GetPlayerATKDMG",40)) //10
  DamageType "Magic"
  PROJECTILE
  Renderstyle Add

  States
  {
  Spawn:
	FX11 ABABABAB 5 bright
	goto Summon
  Summon:
	FX11 A 0
	{ 
	 A_SpawnItem("TeleportFog",0,0,0,0);
	 A_SpawnItem("FWizard",0,0,0,0);
	}
	stop
  Death:
	FX11 CDEFG 5 BRIGHT
	Stop
  }
}

actor DSparilStaff : weapon
{
  Weapon.Ammouse1 5
  Weapon.Ammouse2 15
  Weapon.Ammogive 50
  Weapon.Ammotype1 "BlasterAmmo"
  Weapon.Ammotype2 "BlasterAmmo"
  Inventory.Pickupmessage "staff of d'sparil"
  Obituary "%o was no match for %k's staff of D'Sparil"
  Tag "Staff of D'Sparil"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
    DSTF B 0 NoDelay
	{
	 if (CountInv("DSparilStaff",AAPTR_PLAYER1) > 0)
	 {
	  A_SpawnItemEx("DualDSparilStaff");
	  A_FadeOut(1,1);
	 }
	}
	DSTF A 1
	Loop
  Ready:
	DSTF A 1 A_WeaponReady(WRF_ALLOWUSER1)
	Loop
  Select:
	DSTF A 1 { A_Raise; A_Raise; }
	Loop
  Deselect:
	DSTF A 1 { A_Lower; A_Lower; }
	Loop
  Fire:
	DSTF B 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTF C 4 bright
	DSTF D 4 bright
	DSTF E 4 bright
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",0,1);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",0,1);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("Sorcerer2FX1New",0,1);
	 }
	}
	DSTF F 4 bright
	DSTF A 4 A_ReFire
	goto ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",1,2) == 0, "Ready")
	DSTF B 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTF C 4 bright
	DSTF D 4 bright
	DSTF E 4 bright
	{ 
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25,1,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25,1,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25,0,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("Sorcerer2FX3",25,1,0);
  	  A_FireCustomMissile("Sorcerer2FX3",-25,0,0);
	 }
	}
	DSTF F 4 bright
	DSTF A 4 A_ReFire
	goto Ready
  }
}

actor DualDSparilStaff : DSparilStaff
{
  Weapon.Ammouse1 5
  Weapon.Ammouse2 15
  Weapon.Ammogive 50
  Weapon.Ammotype1 "BlasterAmmo"
  Weapon.Ammotype2 "BlasterAmmo"
  Inventory.Pickupmessage "staff of d'sparil"
  Obituary "%o was no match for %k's staves of D'Sparil"
  Tag "Dual Staves of D'Sparil"
  States
  {
  User1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseStaminaAttack",ACS_NamedExecuteWithResult("GetKickStaminaUse",0),2) == 0, "Ready")
	TNT1 A 0 
	{
	 if (random(1,256) >= 253)
	 {
	  if (CountInv("PlayingStrife",AAPTR_PLAYER1) > 0) { } // Strife mode makes the punch work like the Punch Dagger where it NEVER makes sound
	  else
	  {
	   A_AlertMonsters; // Sometimes a swing will be enough to wake up all monsters in the area.
	  }
	 }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,32)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104);
	 }
	}
    FKIC B 1 Offset(24,34)
	{
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle-15);
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104);
	 }
	}
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready
  Spawn:
	DSTF A -1
	Stop
  Ready:
	DSTD A 1 A_WeaponReady(WRF_ALLOWUSER1)
	Loop
  Select:
	DSTD A 1 { A_Raise; A_Raise; }
	Loop
  Deselect:
	DSTD A 1 { A_Lower; A_Lower; }
	Loop
  Fire:
	DSTD B 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTD C 4 bright 
	DSTD D 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTD E 4 bright
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",3,1,3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",3,1,3);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",3,0,3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("Sorcerer2FX1New",3,1,3);
	 }
	}
	DSTD F 4 bright 
	DSTD G 4 bright
	{
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",-3,1,-3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,1,-3);
      A_SetAngle(angle-15);
      A_FireCustomMissile("Sorcerer2FX1New",-3,0,-3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
      A_FireCustomMissile("Sorcerer2FX1New",-3,1,-3);
	 }
	}
	DSTD H 4 bright
	DSTD A 4 A_ReFire
	goto ready
  AltFire:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("UseManaAttack",2,2) == 0, "Ready")
	DSTD B 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTD C 4 bright
	DSTD D 4 bright A_PlayWeaponSound("dsparil/attack")
	DSTD E 4 bright
	{ 
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,1,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,1,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25+3,0,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("Sorcerer2FX3",25+3,1,3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25+3,0,3);
	 }
	}
	DSTD F 4 bright
	DSTD G 4 bright
	{ 
     ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (CountInv("SpreaderAura2",AAPTR_PLAYER1) > 0)
	 {
      // Angle + 15, Pitch + 0
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle + 7.5, Pitch + 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch+7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle + 7.5, Pitch - 7.5
      A_SetPitch(pitch-15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle + 0, Pitch + 0
      A_SetPitch(pitch+7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,1,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle - 7.5, Pitch - 7.5
      A_SetAngle(angle-7.5);
      A_SetPitch(pitch-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle - 7.5, Pitch + 7.5
      A_SetPitch(pitch+15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Angle - 15, Pitch + 0
      A_SetPitch(pitch-7.5);
      A_SetAngle(angle-7.5);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      // Reset
      A_SetAngle(angle+15);
	 }
	 else
	 if (CountInv("SpreaderAura1",AAPTR_PLAYER1) > 0)
	 {
      A_SetAngle(angle+15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,1,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      A_SetAngle(angle-15);
	  A_FireCustomMissile("Sorcerer2FX3",25-3,0,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
      A_SetAngle(angle+15);
	 }
	 else
	 {
	  A_FireCustomMissile("Sorcerer2FX3",25-3,1,-3);
  	  A_FireCustomMissile("Sorcerer2FX3",-25-3,0,-3);
	 }
	}
	DSTD H 4 bright
	DSTD A 4 bright A_ReFire
	goto Ready
  }
}

