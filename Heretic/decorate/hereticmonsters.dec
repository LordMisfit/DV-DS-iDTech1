// Heretic Monsters

ACTOR ChickenNew : AetheriusMorphedMonster replaces Chicken
{
	Health 10
	Radius 9
	Height 22
	Mass 40
	Speed 4
	Painchance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Normal", 0.5
	DamageFactor "Crush", 32
	Monster
	-COUNTKILL
	+WINDTHRUST
	+DONTMORPH
	+FLOORCLIP
	SeeSound "chicken/pain"
	AttackSound "chicken/attack"
	PainSound "chicken/pain"
	DeathSound "chicken/death"
	ActiveSound "chicken/active"
	Obituary "$OB_CHICKEN"
	States
	{
		Spawn:
			CHKN A 0 NoDelay 
			CHKN AB 10 A_Look
			goto Spawn+1
		See:
			CHKN A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			CHKN AB 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			CHKN A 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }
				A_FaceTarget;
			}
			CHKN C 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }

				A_MonsterCrisisCheck;
				A_CustomMeleeAttack(random[ChicAttack](1,2));
			}
			Goto See
		Pain:
			CHKN D 5 A_Feathers
			CHKN C 5 A_Pain
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			CHKN E 6 A_Scream
			CHKN F 6 A_Feathers
			CHKN G 6
			CHKN H 6 A_NoBlocking
			CHKN IJK 6 
			CHKN L -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			IMPX G 5 A_GenericFreezeDeath
			IMPX G 1 A_FreezeDeathChunks
			wait
	}
}
actor FChicken : ChickenNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor HereticImpNew : AetheriusMonsterZSC // replaces HereticImp
{ 
	Health 40
	Radius 16
	Height 36
	Mass 50
	Speed 10
	PainChance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 10
	Monster
	+FLOAT
	+NOGRAVITY
	+SPAWNFLOAT
	+DONTOVERLAP
	+MISSILEMORE
	+DONTHARMSPECIES
	Species "Gargoyle"
	Damage (0)
	SeeSound "himp/sight"
	AttackSound "himp/attack"
	PainSound "himp/pain"
	DeathSound "himp/death"
	ActiveSound "himp/active"
	Obituary "$OB_HERETICIMP"
	HitObituary "$OB_HERETICIMPHIT"

	states
	{
		Spawn:
			IMPX A 0 NoDelay 
			IMPX ABCB 10 A_FloatLook(24)
			goto Spawn+1
		See:
			IMPX A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			IMPX AABBCCBB 3
			{
				A_FloatChaseCheck(6,12,18,24,0.333,0.333);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			IMPX DE 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				A_FaceTarget;
			}
			IMPX F 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[ImpMeAttack](5,12), "himp/attack", "himp/attack");
			}
			Goto See
		Missile:
			IMPX A 0
			{
				if (levelbehavior > 0 && user_monsterlevel > 300) { user_chargechance = 70; }
				else if (levelbehavior > 0 && user_monsterlevel > 280) { user_chargechance = 67; }
				else if (levelbehavior > 0 && user_monsterlevel > 260) { user_chargechance = 64; }
				else if (levelbehavior > 0 && user_monsterlevel > 240) { user_chargechance = 61; }
				else if (levelbehavior > 0 && user_monsterlevel > 220) { user_chargechance = 58; }
				else if (levelbehavior > 0 && user_monsterlevel > 200) { user_chargechance = 55; }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { user_chargechance = 52; }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { user_chargechance = 49; }
				else if (levelbehavior > 0 && user_monsterlevel > 140) { user_chargechance = 46; }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { user_chargechance = 43; }
				else if (levelbehavior > 0 && user_monsterlevel > 100) { user_chargechance = 40; }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { user_chargechance = 37; }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { user_chargechance = 34; }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { user_chargechance = 31; }
				else if (levelbehavior > 0 && user_monsterlevel > 20) { user_chargechance = 28; }
				else { user_chargechance = 25; }

				if (random(1,100) > user_chargechance) { return state("See"); }
				else 
				{
					if (AAPTR_TARGET == AAPTR_NULL) { return state("See"); }
					return state("");
				}
				return state("");
			}
		Charge:
			IMPX A 10
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			IMPX B 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				// A_ImpMsAttack; Emulation
				SetDamage(((0+(user_monsterlevel/45))));
				A_MonsterCrisisCheck;
				if(user_canusecrisisatk == 1) 
				{
					if (user_monsterlevel >= 45) { A_PlayCrisisAtkSound; } 
					SetDamage((((0+(user_monsterlevel/45)))*CallACS("CrisisMultiplier"))); 
				}
				A_SkullAttack(12+(user_monsterlevel/random(22,23)));
			}
			IMPX CBAB 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			Goto Charge+2
		Pain:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,12,48)
			Goto See
		Pain.Fist:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,12,48)
			IMPX GG 3
			Goto See
		Pain.Kick:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,12,48)
			IMPX GGGG 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			IMPX G 4 A_ImpDeath
			IMPX H 5 
			Wait
		XDeath:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			IMPX S 5 A_ImpXDeath1
			IMPX TU 5
			IMPX V 5 A_Gravity
			IMPX W 5 
			Wait
		Crash:
			IMPX I 7 A_ImpExplode
			IMPX J 7 A_Scream
			IMPX K 7
			IMPX L -1
			Stop
		XCrash:
			IMPX X 7
			IMPX Y 7
			IMPX Z -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			IMPX G 5 A_GenericFreezeDeath
			IMPX G 1 A_FreezeDeathChunks
			wait
		Raise:
			IMPX H 5 
			IMPX G 4
			goto See
	}
}
actor FHereticImp : HereticImpNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor HereticImpLeaderNew : HereticImpNew // replaces HereticImpLeader
{
	Health 80
	Painchance 150
	Painchance "Fist", 225 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 225 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 10
	Species "Gargoyle"
	-MISSILEMORE
	+DONTHARMSPECIES
	AttackSound "himp/leaderattack"
	Translation "141:141=144:144", "145:160=145:153", "248:254=248:251", "66:94=66:80", "95:110=95:103"

	states
	{
		Melee:
			Stop
		Missile:
			IMPX D 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			IMPX DE 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				A_FaceTarget;
			}
			IMPX F 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("HereticImpBallNew", "HereticImpBallCrisis", 16, random[ImpMsAttack2](5,12), "himp/leaderattack");
			}
			Goto See
	}
}
actor FHereticImpLeader : HereticImpLeaderNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

// Plague Gargoyle
ACTOR PlagueImp : HereticImpLeaderNew 31026
{  
	Health 120
	DamageFactor "Crush", 7.6
	Scale 1
	Painchance 160
	Painchance "Fist", 240 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 240 // Fist attacks have a +50% chance of stunning an enemy
	+DONTHARMSPECIES
	Species "Gargoyle"
	Obituary "%o was poisoned by a plague gargoyle"
	HitObituary "%o was ripped up by a plague gargoyle"
	Translation "145:168=225:240", "255:248=0:0"

	States
	{
		Spawn:
			IMPX A 0 NoDelay 
			IMPX ABCB 10 A_FloatLook(16)
			goto Spawn+1
		See:
			IMPX A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			IMPX AABBCCBB 3
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			IMPX DE 6
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				A_FaceTarget;
			}
			IMPX F 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[ImpMeAttack](6,14), "himp/attack", "himp/attack");
			}
			Goto See
		Missile:
			IMPX DE 6
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				A_FaceTarget;
			}
			IMPX F 6 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("PlagueShot", "PlagueShotCrisis", 16, 0, frandom(-6.0,6.0));
			}
			Goto See
		Pain:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,8,64)
			Goto See
		Pain.Fist:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,8,64)
			IMPX GG 3
			Goto See
		Pain.Kick:
			IMPX G 3
			IMPX G 3 A_FloatPain(0,8,64)
			IMPX GGGG 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			IMPX G 4 A_ImpDeath
			IMPX H 5 
			Wait
		XDeath:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			IMPX S 5 A_ImpXDeath1
			IMPX TU 5
			IMPX V 5 A_Gravity
			IMPX W 5 
			Wait
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			IMPX G 5 A_GenericFreezeDeath
			IMPX G 1 A_FreezeDeathChunks
			wait
		Crash:
			IMPX I 0 A_ChangeFlag("NOGRAVITY",0)
			IMPX I 0 A_SpawnItemEx("HereticImpChunk1", 0, 0, 0, random(-4,4), random(-4,4), 9, 0, SXF_TRANSFERTRANSLATION + SXF_NOCHECKPOSITION, 0)
			IMPX I 0 A_SpawnItemEx("HereticImpChunk2", 0, 0, 0, random(-4,4), random(-4,4), 9, 0, SXF_TRANSFERTRANSLATION + SXF_NOCHECKPOSITION, 0)
			IMPX I 7 
			IMPX J 7 A_Scream
			IMPX K 7
			IMPX L -1
			Stop
		XCrash:
			IMPX X 7 
			IMPX Y 7
			IMPX Z -1
			Stop
		Raise:
			IMPX L 0  
			IMPX L 0 A_RemoveChildren
			IMPX LKJIHG 6
			Goto See
	}
}

ACTOR PlagueShot : AetheriusEffectProjectile
{
	Damage (3*random(3,5))
	Radius 8
	Height 16
	Speed 16
	PROJECTILE
	+THRUGHOST
	scale 0.5
	SeeSound "himp/leaderattack"
	DeathSound "monster/plaugeBall"

	States
	{
		Spawn:
			FVUL AAABBB 1 Bright
			loop
		Death:
			TNT1 A 0 Bright
			{
				if (IsPointerEqual(AAPTR_MASTER, AAPTR_PLAYER1) == TRUE) 
				{
					A_StatusEffectChecker(3);
					if (random(1,user_ailmentmaxchance) <= 3 && user_canafflict > 0)
					{
						ACS_NamedExecuteAlways("BuffTimer",0,8,16,random(140,210)); // Poison for 4-6 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					}
				}
				return state("");
			}
		Death2:
			FVUL CDEF 4 Bright
			stop
	}
}
actor PlagueShotCrisisParticle : BaseCrisisParticle
{
	scale 0.334

	States
	{
		Spawn:
			FVUL A 0 NoDelay A_CrisisParticleInit
			goto Idle
		Idle:
			"####" AAABBB 1 Bright A_CrisisParticleDo
			loop
	}
}
ACTOR PlagueShotCrisis : PlagueShot
{
	Damage ((3*random(3,5)) * CallACS("CrisisMultiplier"))
	States
	{
		Spawn:
			FVUL AAABBB 1 Bright
			{
				A_SpawnItemEx("PlagueShotCrisisParticle",0,0,0,0,0,1.28);
			}
			loop
		Death:
			TNT1 A 0 Bright
			{
				if (IsPointerEqual(AAPTR_MASTER, AAPTR_PLAYER1) == TRUE) 
				{
					A_StatusEffectChecker(8);
					if (random(1,user_ailmentmaxchance) <= 3 && user_canafflict > 0)
					{
						ACS_NamedExecuteAlways("BuffTimer",0,8,16, (random(140,210)*CallACS("CrisisMultiplier",5)) ); // Poison for 4-6 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					}
				}
				return state("");
			}
		Death2:
			FVUL CDEF 4 Bright
			stop
	}
}

// Dark/Watcher Gargoyle
ACTOR WatcherImp : HereticImpNew 
{
	Health 120
	Radius 16
	Height 36
	Mass 50
	Speed 15
	scale 1.2
	Monster
	+FLOAT
	+NOGRAVITY
	+SPAWNFLOAT
	+DONTOVERLAP
	+MISSILEMORE
	SeeSound "himp/sight"
	AttackSound "himp/attack"
	PainSound "himp/pain"
	DeathSound "himp/death"
	ActiveSound "himp/active"
	Obituary "%o was burnt by a Watcher Gargoyle."
	HitObituary "%o was slashed by a Watcher Gargoyle."

	DamageFactor "Fire", 0.5
	DamageFactor "Crush", 7.6
	PainChance 50
	Painchance "Fire", 25 // Fire attacks have a -50% chance of stunning an enemy
	Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
	+DONTHARMSPECIES
	Species "Gargoyle"

	States
	{
		Spawn:
			WATC A 0 NoDelay 
			WATC ABCB 10 A_FloatLook(12)
			goto Spawn+1
		See:
			WATC A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			WATC AABBCCBB 3
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop

		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			WATC DE 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_FaceTarget;
			}
			WATC F 4 BRIGHT 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[ImpMeAttack](7,14), "himp/attack");
			}
			WATC "[\" 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_FaceTarget;
			}
			WATC ] 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[ImpMeAttack](7,14), "himp/attack");
			}
			Goto See

		Missile:
			WATC D 0
			{
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
				user_firevolleys = 0;
				user_firevolleymax = random(2,3);
				if (random(1,16) == 1) { user_firevolleymax *= random(3,4); }
			}
			WATC D 0 BRIGHT A_Jump(85,"Beastball")
		MissileLoop:
			WATC DE 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_FaceTarget;
			}
			WATC F 4 BRIGHT 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("HereticImpBall2", "HereticImpBall2Crisis", 14, 14, "himp/leaderattack");
			}
			WATC "[\" 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_FaceTarget;
			}
			WATC ] 4 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("HereticImpBall2", "HereticImpBall2Crisis", 14, 14, "himp/leaderattack");
			}
			WATC ] 0 BRIGHT
			{
				user_firevolleys += 1;
				if (user_firevolleys >= user_firevolleymax) { return state("See"); }
				return state("");
			}
			loop
		Beastball:
			WATC DE 6 BRIGHT
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }
				A_FaceTarget;
			}
			WATC F 6 BRIGHT 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("BeastBall2", "BeastBall2Crisis", 14, random[BeastAttack](1,8)*3, "beast/attack");
			}
			Goto See
		Pain:
			WATC G 3
			WATC G 3 A_FloatPain(0,6,96)
			Goto See
		Pain.Fist:
			WATC G 3
			WATC G 3 A_FloatPain(0,6,96)
			WATC GG 3
			Goto See
		Pain.Kick:
			WATC G 3
			WATC G 3 A_FloatPain(0,6,96)
			WATC GGGG 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			WATC G 4 A_ImpDeath
			WATC H 5
			Wait
		XDeath:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			WATC S 5 A_ImpXDeath1
			WATC TU 5
			WATC V 5 A_Gravity
			WATC W 5 
			Wait
		Crash:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			WATC I 7 A_ImpExplode
			WATC J 7 A_Scream
			WATC K 7
			WATC L -1
			Stop
		XCrash:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			WATC X 7
			WATC Y 7
			WATC Z -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			WATC G 5 A_GenericFreezeDeath
			WATC G 1 A_FreezeDeathChunks
			wait
		Raise:
			WATC H 5 
			WATC G 4
			goto See
	}
}

actor MummyNew : AetheriusMonsterZSC // replaces Mummy
{
	Health 80
	Radius 22
	Height 62
	Mass 75
	Speed 12
	Painchance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 8
	Species "Golem"
	Monster
	+FLOORCLIP
	+DONTHARMSPECIES
	SeeSound "mummy/sight"
	AttackSound "mummy/attack1"
	PainSound "mummy/pain"
	DeathSound "mummy/death"
	ActiveSound "mummy/active"
	HitObituary "%o was smashed by a golem."
	DropItem "GoldWandAmmo", 84, 3

	states
	{
		Spawn:
			MUMM A 0 NoDelay 
			MUMM AB 10 A_Look
			goto Spawn+1
		See:
			MUMM A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MUMM ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMM E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			MUMM F 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[MummyAttack](1,8)*2, "mummy/attack2", "mummy/attack");
			}
			MUMM G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			MUMM H 4
			MUMM H 4 A_Pain
			Goto See
		Pain.Fist:
			MUMM H 4
			MUMM H 4 A_Pain
			MUMM HH 4
			Goto See
		Pain.Kick:
			MUMM H 4
			MUMM H 4 A_Pain
			MUMM HHHH 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			MUMM I 5
			MUMM J 5 A_Scream
			MUMM K 5 A_SpawnItemEx("MummySoul", 0, 0, 10, 0, 0, 1)
			MUMM L 5
			MUMM M 5 A_NoBlocking
			MUMM NO 5 
			MUMM P -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			MUMM H 5 A_GenericFreezeDeath
			MUMM H 1 A_FreezeDeathChunks
			wait
		Raise:
			MUMM O 5 
			MUMM NMLKJI 5
			goto See
	}
}
actor FMummy : MummyNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor MummyGhostNew : MummyNew // replaces MummyGhost
{
	+SHADOW
	+GHOST
	RenderStyle Translucent
	Alpha 0.4

	states
	{
		Spawn:
			MUMM A 0 NoDelay 
			MUMM AB 10 A_Look
			goto Spawn+1
		See:
			MUMM A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MUMM ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMM E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			MUMM F 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[MummyAttack](1,8)*2, "mummy/attack2", "mummy/attack");
			}
			MUMM G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			MUMM H 4
			MUMM H 4 A_Pain
			Goto See
		Pain.Fist:
			MUMM H 4
			MUMM H 4 A_Pain
			MUMM HH 4
			Goto See
		Pain.Kick:
			MUMM H 4
			MUMM H 4 A_Pain
			MUMM HHHH 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			MUMM I 5
			MUMM J 5 A_Scream
			MUMM K 5 A_SpawnItemEx("MummySoul", 0, 0, 10, 0, 0, 1)
			MUMM L 5
			MUMM M 5 A_NoBlocking
			MUMM NO 5 
			MUMM P -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			MUMM H 5 A_GenericFreezeDeath
			MUMM H 1 A_FreezeDeathChunks
			wait
		Raise:
			MUMM O 5 
			MUMM NMLKJI 5
			goto See
	}
}
actor FMummyGhost : MummyGhostNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor MummyLeaderNew : AetheriusMonsterZSC // replaces MummyLeader
{
	Health 100
	Radius 22
	Height 62
	Mass 75
	Speed 12
	PainChance 64
	Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 8
	Species "Golem"
	Monster
	+FLOORCLIP
	+DONTHARMSPECIES
	SeeSound "mummy/sight"
	AttackSound "mummy/attack1"
	PainSound "mummy/pain"
	DeathSound "mummy/death"
	ActiveSound "mummy/active"
	Obituary "$OB_MUMMYLEADER"
	HitObituary "%o was smashed by a golem."
	DropItem "GoldWandAmmo", 84, 3

	states
	{
		Spawn:
			MUMA A 0 NoDelay 
			MUMA AB 10 A_Look
			goto Spawn+1
		See:
			MUMA A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MUMA ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMM E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			MUMM F 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[MummyAttack](1,8)*2, "mummy/attack2", "mummy/attack");
			}
			MUMM G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
				A_MonsterCrisisCheck;
				A_CrisisComboAttack("MummyFX1", "MummyFX1Crisis", 32, random[MummyAttack2](1,8)*2, "mummy/attack2");
			}
			Goto See
		Pain:
			MUMA H 4
			MUMA H 4 A_Pain
			Goto See
		Pain.Fist:
			MUMA H 4
			MUMA H 4 A_Pain
			MUMA HH 4
			Goto See
		Pain.Kick:
			MUMA H 4
			MUMA H 4 A_Pain
			MUMA HHHH 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			MUMM I 5
			MUMM J 5 A_Scream
			MUMM K 5 A_SpawnItemEx("MummySoul", 0, 0, 10, 0, 0, 1)
			MUMM L 5
			MUMM M 5 A_NoBlocking
			MUMM NO 5 
			MUMM P -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			MUMA H 5 A_GenericFreezeDeath
			MUMA H 1 A_FreezeDeathChunks
			wait
		Raise:
			MUMM O 5 
			MUMM NMLKJI 5
			goto See
	}
}
actor FMummyLeader : MummyLeaderNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor MummyLeaderGhostNew : MummyLeaderNew // replaces MummyLeaderGhost
{
	+SHADOW
	+GHOST
	RenderStyle Translucent
	Alpha 0.4

	states
	{
		Spawn:
			MUMA A 0 NoDelay 
			MUMA AB 10 A_Look
			goto Spawn+1
		See:
			MUMA A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MUMA ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMA E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			MUMA F 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[MummyAttack](1,8)*2, "mummy/attack2", "mummy/attack");
			}
			MUMA G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA X 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			MUMA Y 5 Bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
				A_MonsterCrisisCheck;
				A_CrisisComboAttack("MummyFX1", "MummyFX1Crisis", 32, random[MummyAttack2](1,8)*2, "mummy/attack2");
			}
			Goto See
		Pain:
			MUMA H 4
			MUMA H 4 A_Pain
			Goto See
		Pain.Fist:
			MUMA H 4
			MUMA H 4 A_Pain
			MUMA HH 4
			Goto See
		Pain.Kick:
			MUMA H 4
			MUMA H 4 A_Pain
			MUMA HHHH 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			MUMM I 5
			MUMM J 5 A_Scream
			MUMM K 5 A_SpawnItemEx("MummySoul", 0, 0, 10, 0, 0, 1)
			MUMM L 5
			MUMM M 5 A_NoBlocking
			MUMM NO 5 
			MUMM P -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			MUMA H 5 A_GenericFreezeDeath
			MUMA H 1 A_FreezeDeathChunks
			wait
		Raise:
			MUMM O 5 
			MUMM NMLKJI 5
			goto See
	}
}
actor FMummyLeaderGhost : MummyLeaderGhostNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

// Ice Golem
Actor IceGolem : AetheriusMonsterZSC
{
	Health 450
	Radius 22
	Height 62
	Mass 900
	Speed 16
	Painchance 32
	Painchance "Fire", 56 // Fire attacks have a +80% chance of stunning an enemy
	Painchance "Ice", 0 // Ice can't stun Ice Golems
	Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 80 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
	RadiusDamageFactor 0.625
	DamageFactor "Crush", 5.6
	DamageFactor "Normal", 0.925
	DamageFactor "Fire", 1.8
	DamageFactor "Ice", 0.0
	Monster
	+FLOORCLIP
	+NOBLOOD
	+DONTHARMSPECIES
	RenderStyle Translucent
	Alpha 0.8
	Scale 1.0
	SeeSound "mummy/sight"
	AttackSound "mummy/attack1"
	PainSound "mummy/pain"
	ActiveSound "mummy/active"
	HitObituary "%o was bludgeoned by an ice golem"
	Species "Golem"
	var int user_HalfMaxHP;
	var int user_regenchance;

	States
	{
		Spawn:
			IGLM A 0 NoDelay 
			IGLM AB 10 A_Look
			goto Spawn+1
		See:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			IGLM ABCD 5
			{
				user_HalfMaxHP = user_MaxHP / 2;
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(4); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(3); }
				A_Chase;
				
				if (health <= user_HPCritRange) { user_regenchance = 32; }
				else if (health <= user_HPLowRange) { user_regenchance = 8; }
				else if (health <= user_HalfMaxHP) { user_regenchance = 4; }
				else if (health <= user_MaxHP) { user_regenchance = 2; }

				if (random(1,256) <= user_regenchance) 
				{
					return state("RegenerateStart"); 
				}
				return state("");
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			IGLM E 0 A_Jump(128, "Melee2")
			IGLM E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			IGLM F 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(Random(15,27)*3, "mummy/attack2", "mummy/attack");
			}
			IGLM G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		Melee2:
			IGLM H 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			IGLM I 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(Random(15,27)*3, "mummy/attack2", "mummy/attack");
			}
			IGLM J 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 75) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See
		RegenerateStart:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			IGLM K 10
			{
				user_regencyclemax = 10;
				A_PlayWeaponSound("misc/freeze");
				A_ChangeFlag("CANTSEEK",1);
				A_ChangeFlag("NOPAIN",1);
				A_ChangeFlag("NOTHRUST",1);
				A_GiveInventory("IceGolemArmor",1);
			}
		Regenerate:
			IGLM K 0 { if (health < user_MaxHP) { HealThing((user_MaxHP/random(18,22))); user_regencycles += 1; } else { return state("RegenerateEnd"); } return state(""); }
			IGLM KKKKKKKKKK 1 A_SpawnItemEx("IceGolemParticleA", Random(24, 32), 0, 4, 0, 0, (Random(20, 35)*0.1), Random(0, 360), 128)
		RegenerateCheck:
			IGLM K 0
			{
				if (user_regencycles < user_regencyclemax) { return state("Regenerate"); }
				if (health < user_MaxHP)
				{
					if (random(1,8) == 1) { user_regencycles = 0; return state("Regenerate"); }
					return state("");
				}
				return state("");
			}
		RegenerateEnd:
			IGLM K 0
			{
				user_regencycles = 0;
				user_regencyclemax = 0;
				A_ChangeFlag("CANTSEEK",0);
				A_ChangeFlag("NOPAIN",0);
				A_ChangeFlag("NOTHRUST",0);
				A_TakeInventory("IceGolemArmor",0x7FFFFFFF);
			}
			Goto See
		Pain:
			IGLM L 4
			IGLM L 4 A_Pain
			Goto See
		Pain.Fist:
			IGLM L 4
			IGLM L 4 A_Pain
			IGLM LL 4
			Goto See
		Pain.Kick:
			IGLM L 4
			IGLM L 4 A_Pain
			IGLM LLLL 4
			Goto See
		Pain.Fire:
			IGLM L 4
			IGLM L 4 A_Pain
			IGLM L 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			IGLM L 12
			IGLM L 0 A_SetTranslucent(1.0, 0)
			IGLM L 1 A_IceGuyDie
			Stop
	}
}

Actor IceGolemGhost : IceGolem
{
	+SHADOW
	+GHOST
	RenderStyle Translucent
	Alpha 0.32
}

Actor IceGolemArmor : PowerProtection
{
	damagefactor "normal", 0.01 
	inventory.icon ""
	Powerup.Duration 2147483646
}

Actor IceGolemParticleA
{
	Height 0
	Radius 0
	Mass 0
	+Missile
	+NoBlockMap
	+NoGravity
	+DontSplash
	+NoClip
	RenderStyle Add
	Scale 0.0275
	States
	{
		Spawn:
			IGLP A 0 A_SpawnItemEx("IceGolemParticleTrail", -(MomX*1.2), -(MomY*1.2), (MomZ*-1.2), (MomX*0.8), (MomY*0.8), (MomZ*0.8), -Angle, 138)
			IGLP A 1 A_FadeOut(0.065)
			Loop
	}
}

Actor IceGolemParticleTrail : IceGolemParticleA
{
	States
	{
		Spawn:
			IGLP A 1 A_FadeOut(0.075)
			Loop
	}
}

ACTOR KnightNew : AetheriusMonsterZSC // replaces Knight
{
	Health 200
	Radius 24
	Height 78
	Mass 150
	Speed 12
	Painchance 100
	Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 7.2
	Monster
	+FLOORCLIP
	SeeSound "hknight/sight"
	AttackSound "hknight/attack"
	PainSound "hknight/pain"
	DeathSound "hknight/death"
	ActiveSound "hknight/active"
	Obituary "$OB_BONEKNIGHT"
	HitObituary "$OB_BONEKNIGHTHIT"
	DropItem "CrossbowAmmo", 84, 5

	States
	{
		Spawn:
			KNIG A 0 NoDelay 
			KNIG AB 10 A_Look
			goto Spawn+1
		See:
			KNIG A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			KNIG ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			KNIG E 10
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			KNIG F 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }
				A_FaceTarget;
			}
			KNIG G 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }

				A_MonsterCrisisCheck;
				if (bSHADOW == 1 || random(1,256) <= 40)
				{
					A_CrisisComboAttack("RedAxeNew", "RedAxeCrisis", 36, random[KnightAttack](1, 8) * 10, "hknight/melee");
				}
				else
				{
					A_CrisisComboAttack("KnightAxeNew", "KnightAxeCrisis", 36, random[KnightAttack](1, 8) * 3, "hknight/melee");
				}
				// A_KnightAttack;
			}
			KNIG E 10
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			KNIG F 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }
				A_FaceTarget;
			}
			KNIG G 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }

				A_MonsterCrisisCheck;
				if (bSHADOW == 1 || random(1,256) < 40)
				{
					A_CrisisComboAttack("RedAxeNew", "RedAxeCrisis", 36, random[KnightAttack](1, 8) * 10, "hknight/melee");
				}
				else
				{
					A_CrisisComboAttack("KnightAxeNew", "KnightAxeCrisis", 36, random[KnightAttack](1, 8) * 3, "hknight/melee");
				}
				//A_KnightAttack;
			}
			Goto See
		Pain:
			KNIG H 3
			KNIG H 3 A_Pain
			Goto See
		Pain.Fist:
			KNIG H 3
			KNIG H 3 A_Pain
			KNIG HH 3
			Goto See
		Pain.Kick:
			KNIG H 3
			KNIG H 3 A_Pain
			KNIG HHHH 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			KNIG I 6
			KNIG J 6 A_Scream
			KNIG K 6
			KNIG L 6 A_NoBlocking
			KNIG MN 6 
			KNIG O -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			KNIG H 5 A_GenericFreezeDeath
			KNIG H 1 A_FreezeDeathChunks
			wait
		Raise:
			KNIG N 6 
			KNIG MLKJI 6
			goto See
	}
}
actor FKnight : KnightNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}
ACTOR KnightGhostNew : KnightNew // replaces KnightGhost
{
	+SHADOW
	+GHOST
	RenderStyle Translucent
	Alpha 0.4
}

actor FKnightGhost : KnightGhostNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

// Death Knight
ACTOR DeathKnight : AetheriusMonsterZSC 30114 
{ 
	Health 1100
	Radius 24
	Height 72
	Mass 700 
	Speed 10
	MeleeDamage 10
	PainChance 20 
	Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 50 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Holy", 35 // Holy attacks have a +75% chance of stunning an enemy
	DamageFactor "Normal", 0.875
	DamageFactor "Holy", 1.75
	DamageFactor "Crush", 7.2
	MONSTER
	+FLOORCLIP 
	+NOTARGET 
	+NORADIUSDMG
	+MISSILEMORE
	+BOSS
	+DEFLECT
	+AVOIDMELEE
	+DONTHARMSPECIES
	Obituary "%o got thought %g could kill a Death Knight."
	HitObituary "A Death Knight hacked %o into pieces." 
	MeleeSound "monster/dknhit" 
	SeeSound "monster/dknsit" 
	PainSound "monster/dknpai" 
	DeathSound "monster/dkndth" 
	ActiveSound "monster/dknact" 
	Species "UndeadWarrior"

	States 
	{
		Spawn: 
			DKNT A 0 NoDelay 
			DKNT AB 10 A_Look 
			goto Spawn+1 
		See:
			DKNT A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			DKNT A 0 A_Jump(51,"SeeShielded")
			DKNT AABBCCDD 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_DeathKnightShieldOff;
				A_Chase;
			}
			loop
		SeeShielded:
			DKNT P 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			DKNT PPQQRRSS 3 // A_SetReflectiveInvulnerable
			{
				A_DeathKnightShieldOn;
				A_Chase;
			}
			DKNT S 0
			{
				if (random(1,100) >= 20) { return state("See"); }
				return state("");
			}
			loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			DKNT E 0 // A_UnSetReflectiveInvulnerable
			{
				A_DeathKnightShieldOff;
			}
			DKNT E 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			DKNT F 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
				A_Playsound("monster/dknswg");
			}
			DKNT G 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(10*random(1,8), "monster/dknhit");
			}
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			DKNT E 0 A_Jump(88,"Attack1")
			DKNT E 0 A_Jump(88,"Attack2")
			DKNT E 0 Bright // A_UnSetReflectiveInvulnerable
			{
				A_DeathKnightShieldOff;
			}
			DKNT E 6 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			DKNT F 6 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
				A_Playsound("monster/kntswg");
			}
			DKNT G 5 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,-3,0);
				A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,-1,0);
				A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,1,0);
				A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,3,0);
				if (levelbehavior > 0 && user_monsterlevel > 60)
				{
					A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,-5,0);
					A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,5,0);
				}
				if (levelbehavior > 0 && user_monsterlevel > 120)
				{
					A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,-7,0);
					A_CrisisSpawnProjectile("DKDart","DKDartCrisis",32,0,7,0);
				}
			}
			DKNT A 0 A_Jump(64,"Attack2")
			Goto See
		Attack1:
			DKNT T 1 Bright // A_SetReflectiveInvulnerable
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;
	
				user_defendtimer += 1;
	
				if (levelbehavior > 0 && user_monsterlevel > 120) { user_defendtimermax = 4; }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { user_defendtimermax = 5; }
				else { user_defendtimermax = 6; }
				if (user_defendtimer >= user_defendtimermax) { user_defendtimer = 0; return state("Attack1Phase2"); }
				return state("");
			}
			loop
		Attack1Phase2:
			DKNT U 1 Bright
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;
			}
		Attack1Phase3:
			DKNT U 1 Bright 
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;

				user_defendtimer += 1;
				if (user_defendtimer == 2) 
				{
					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("FHeadShot","FHeadShotCrisis",44,-4,-12,0);
					A_CrisisSpawnProjectile("FHeadShot","FHeadShotCrisis",44,-4,12,0);
				}
				
				if (levelbehavior > 0 && user_monsterlevel > 120) { user_defendtimermax = 3; }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { user_defendtimermax = 4; }
				else { user_defendtimermax = 5; }
				if (user_defendtimer >= user_defendtimermax) { user_defendtimer = 0; return state("Attack1End"); }
				return state("");
			}
			loop
		Attack1End:
			DKNT U 0 Bright // A_UnSetReflectiveInvulnerable
			{
				A_DeathKnightShieldOff;
			}
			DKNT U 0 A_Jump(64,"Attack2")
			Goto See
		Attack2:
			DKNT T 0 Bright // A_SetReflectiveInvulnerable
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;
			}
		Attack2Phase1: // 6 times
			DKNT T 1 Bright 
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;

				user_defendtimer += 1;

				if (levelbehavior > 0 && user_monsterlevel > 120) { user_defendtimermax = 2; }
				else { user_defendtimermax = 3; }
				if (user_defendtimer >= user_defendtimermax) 
				{
					user_defendtimer = 0; 
					return state("Attack2Phase2"); 
				}
				return state("");
			}
			loop
		Attack2Phase2: // 6 times
			DKNT U 1 Bright 
			{
				A_DeathKnightShieldOn;
				A_FaceTarget;
	
				user_defendtimer += 1;
				if (user_defendtimer == 1) 
				{
					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("DKbolt","DKboltCrisis",44,-4,0,0); 
				}

				if (levelbehavior > 0 && user_monsterlevel > 120) { user_defendtimermax = 2; }
				else { user_defendtimermax = 3; }
				if (user_defendtimer >= user_defendtimermax) 
				{
					user_defendtimer = 0; 
					user_defendcycles += 1;
					
					if (user_defendcycles >= 6) { return state("Attack2End"); } else { return state("Attack2Phase1"); }
					return state(""); 
				}
				return state("");
			}
			loop
		Attack2End:
			DKNT U 0 Bright // A_UnSetReflectiveInvulnerable
			{
				A_DeathKnightShieldOff;
				A_FaceTarget;
			}
			Goto See
		Pain:
			DKNT H 2 
			DKNT H 2 A_Pain
			goto PainShield
		Pain.Fist:
			DKNT H 2 
			DKNT H 2 A_Pain
			DKNT HH 2 
			goto PainShield
		Pain.Kick:
			DKNT H 2 
			DKNT H 2 A_Pain
			DKNT HHHH 2 
			goto PainShield

		PainShield:
			DKNT T 1 // A_SetReflectiveInvulnerable
			{
				A_DeathKnightShieldOn;
				user_defendtimer += 1;

				if (levelbehavior > 0 && user_monsterlevel > 180) { user_defendtimermax = random(17,18); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { user_defendtimermax = random(16,17); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { user_defendtimermax = random(15,16); }
				else { user_defendtimermax = 15; }

				if (user_defendtimer >= user_defendtimermax)
				{
					user_defendtimer = 0;
					user_defendcycles += 1;
					if (random(1,4) == 1 && A_JumpIfTargetInsideMeleeRange("Melee"))
					{
						A_DeathKnightShieldOff;
						return state("Melee");
					}
					A_FaceTarget;
				}
				if (user_defendcycles >= 7) { return state("PainShieldEnd"); }
				return state("");
			}
			loop
		PainShieldEnd:
			DKNT T 0 // A_UnSetReflectiveInvulnerable
			{
				A_DeathKnightShieldOff;
				A_FaceTarget;

				if (random(1,16) == 1) { return state("SeeShielded"); }
				return state("");
			}
			DKNT H 1
			{
				A_DeathKnightShieldOff;
				A_FaceTarget;
			}
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			DKNT I 0 Bright A_CustomMissile("DKSword",44,32,-90,0)
			DKNT I 8 Bright 
			{
				if (random(1,4) == 1) { A_CustomMissile("EvilWarriorShield",44,-32,90,0); }
				else { A_CustomMissile("DKShield",44,-32,90,0); }
			}
			DKNT J 8 Bright A_Scream 
			DKNT K 8 Bright
			DKNT L 8 Bright A_NoBlocking 
			DKNT M 8 Bright 
			DKNT N 8 Bright 
			DKNT O -1 
			Stop 
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			DKNT H 5 A_GenericFreezeDeath
			DKNT H 1 A_FreezeDeathChunks
			wait
		Raise:
			DKNT Q 8 Bright   
			DKNT NMLKJI 8 Bright
			Goto See 
	}
}

Actor DeathKnightGhost : DeathKnight
{
	+SHADOW
	+GHOST
	RenderStyle Translucent
	Alpha 0.4
	+DONTHARMSPECIES
	Species "UndeadWarrior"
}

ACTOR WizardNew : AetheriusMonsterZSC // replaces Wizard
{
	Health 180
	Radius 16
	Height 68
	Mass 100
	Speed 12
	Painchance 64
	Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 7.2
	Monster
	+FLOAT
	+NOGRAVITY
	+DONTOVERLAP
	SeeSound "wizard/sight"
	AttackSound "wizard/attack"
	PainSound "wizard/pain"
	DeathSound "wizard/death"
	ActiveSound "wizard/active"
	Obituary "$OB_WIZARD"
	HitObituary "$OB_WIZARDHIT"
	DropItem "BlasterAmmo", 84, 10
	DropItem "ArtiTomeOfPower", 4, 0
	Obituary "%o was cursed by a Disciple of D'Sparil."
	HitObituary "%o was scratched by a Disciple of D'Sparil."

	States
	{
		Spawn:
			WZRD A 0 NoDelay 
			WZRD AB 10 A_FloatLook(16)
			goto Spawn+1
		See:
			WZRD A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			WZRD A 3
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			WZRD A 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			WZRD A 3
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			WZRD A 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			WZRD B 3
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			WZRD B 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			WZRD B 3
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			WZRD B 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			WZRD N 6
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(5); }
				A_FaceTarget;
			}
			WZRD O 6
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(5); }
				A_FaceTarget;
			}
			WZRD P 12 
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 23) { A_SetTics(11); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random(1,5)*8, "wizard/melee", none, "Melee", true);
			}
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk1;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk2;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk1;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk2;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk1;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk2;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk1;
			}
			WZRD C 4
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(3); }
				A_WizAtk2;
			}
			WZRD D 12
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 23) { A_SetTics(11); }

				A_MonsterCrisisCheck;
				A_WizAtk3("WizardFX1New","WizardFX1Crisis", 4*random(1,8));
			}
			Goto See
		Pain:
			WZRD E 3 A_GhostOff
			WZRD E 3 A_FloatPain(0,8,64)
			Goto See
		Pain.Fist:
			WZRD E 3 A_GhostOff
			WZRD E 3 A_FloatPain(0,8,64)
			WZRD EE 3
			Goto See
		Pain.Kick:
			WZRD E 3 A_GhostOff
			WZRD E 3 A_FloatPain(0,8,64)
			WZRD EEEE 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			WZRD F 6 A_GhostOff
			WZRD G 6 A_Scream
			WZRD HI 6
			WZRD J 6 A_NoBlocking
			WZRD KL 6 
			WZRD M -1 A_SetFloorClip
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			WZRD Q 5 A_GenericFreezeDeath
			WZRD Q 1 A_FreezeDeathChunks
			wait
		Raise:
			WZRD M 6 
			WZRD LKJIHGF 6
			goto See
	}
}
actor FWizard : WizardNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

ACTOR Banshee : AetheriusMonsterZSC
{
	Health 720
	Radius 12 // 15
	Height 48 // 60
	Mass 515
	Speed 15
	Scale 0.8
	PainChance 100
	Painchance "Fire", 50 // Fire attacks have a -50% chance of stunning an enemy
	Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Fire", 0.5
	DamageFactor "Crush", 4.8
	+FLOAT
	+NOGRAVITY
	+DONTOVERLAP
	+QUICKTORETALIATE 
	+FLOORCLIP 
	+NOTARGET
	SeeSound "Banshee/Sight"
	PainSound "Banshee/Pain"
	DeathSound "Banshee/Death"
	ActiveSound "Banshee/Active"
	MeleeSound "Banshee/Raise"
	MONSTER
	Obituary "%o Heard The Banshee's Wail"
	DropItem "BlasterAmmo", 128, 10
	DropItem "ArtiTomeOfPower", 8, 0    

	States
	{
		Spawn:
			BANS A 0 NoDelay 
			BANS A 1 A_FloatLook(12)
			goto Spawn+1
		See:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			TNT1 A 0 A_UnSetInvulnerable
			BANS A 2
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(1); }
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }

				A_TakeInventory("BansheeMissile5Token",24);
				A_TakeInventory("BansheePainToken",2);

				A_VileChase;
			}
			BANS A 2
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 150) { A_SetTics(1); }
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }

				A_VileChase;
				A_SpawnItem("BansheeTrail",0,0);
			}
			BANS A 0 A_Jump(2,"BansheeTeleport")
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			BANS A 0 A_Jump(2,"Missile3")
			BANS A 0 A_Jump(50,"Missile4")
			BANS A 0 A_Jump(256,"Missile2", "Melee", "Missile1", "Missile5", "Missile6")
			Goto See
		Missile1:
			BANS B 0 A_FaceTarget
			BANS BCD 2	
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }
			}
			BANS B 0 
			{
				if (random(1,256) <= 176) 
				{
					if (random(1,256) <= ACS_NamedExecuteWithResult("GetEvolveChance")) 
					{
						if (random(1,384) <= ACS_NamedExecuteWithResult("GetEvolveChance")) { A_PainAttack("ForgottenOne"); }
						else { A_PainAttack("DSLostSoul2"); }
					}
					else 
					{
						A_PainAttack("DSLostSoul"); 
					}
				}
				else
				{
					if (random(1,256) <= ACS_NamedExecuteWithResult("GetEvolveChance")) 
					{
						if (random(1,384) <= ACS_NamedExecuteWithResult("GetEvolveChance")) { A_DualPainAttack("ForgottenOne"); }
						else { A_DualPainAttack("DSLostSoul2"); }
					}
					else 
					{
						A_DualPainAttack("DSLostSoul"); 
					}
				}
			}
			Goto See
		Missile2:  
			BANS B 0 A_FaceTarget
			BANS BCD 2
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }
			}
			BANS D 0 
			{
				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BansheeFire", "BansheeFireCrisis", 50, 0, -8);
				A_CrisisSpawnProjectile("BansheeFire", "BansheeFireCrisis", 50, 0,  0);
				A_CrisisSpawnProjectile("BansheeFire", "BansheeFireCrisis", 50, 0,  8);
			}
			Goto See
		Missile3:  
			BANS B 0 A_FaceTarget
			BANS BCD 2 
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }
			}
			BANS B 0 A_Jump(256,"BansheeTeleport")
			Goto See
		Missile4:  
			BANS B 0 A_FaceTarget
			BANS BCD 2
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }
			}
			BANS D 0 
			{
				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BansheeFire3", "BansheeFire3Crisis");
			}
			Goto See
		Missile5:  
			BANS B 0 A_FaceTarget
		Missile5Loop:  
			BANS BCD 1
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
			}
			BANS D 0 
			{
				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BansheeFire4", "BansheeFire4Crisis");

				A_GiveInventory("BansheeMissile5Token",1);
				if (CountInv("BansheeMissile5Token") >= 30) { return state("See"); }
				return state("");
			}
			BANS D 1 A_CPosRefire
			loop
		Missile6:  
			BANS B 0 A_FaceTarget
			BANS BCD 2
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }
			}
			BANS D 4
			{
				A_FloatChaseCheck(3,6,9,12,0.625,0.625);
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0,-160);
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0,-128);
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0,-96 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0,-64 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0,-32 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 0  );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 32 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 64 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 96 );
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 128);
				A_CrisisSpawnProjectile("BansheeFire5", "BansheeFire5Crisis", 50, 0, 160);
			}
			Goto See
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			BANS B 0 A_FaceTarget
			BANS BCD 1
			BANS D 4
			{
				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0,-160);
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0,-128);
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0,-96 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0,-64 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0,-32 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 0  );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 32 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 64 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 96 );
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 128);
				A_CrisisSpawnProjectile("BansheeFire2", "BansheeFire2Crisis", 50, 0, 160);
			}
			Goto See
		BansheeTeleport:
			BANS A 0 A_SetInvulnerable
			BANS A 1 A_SetTranslucent(0.90)
			BANS A 1 A_SetTranslucent(0.80)
			BANS A 1 A_SetTranslucent(0.70)
			BANS A 1 A_SetTranslucent(0.60)
			BANS A 1 A_SetTranslucent(0.50)
			BANS A 1 A_SetTranslucent(0.40)
			BANS A 1 A_SetTranslucent(0.30)
			BANS A 1 A_SetTranslucent(0.20)
			BANS A 1 A_SetTranslucent(0.10)
			BANS A 0 A_Jump(128,25)
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
			TNT1 A 0 A_Jump(128,25)
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
			BANS A 1 A_SetTranslucent(0.10)
			BANS A 1 A_SetTranslucent(0.20)
			BANS A 1 A_SetTranslucent(0.30)
			BANS A 1 A_SetTranslucent(0.40)
			BANS A 1 A_SetTranslucent(0.50)
			BANS A 1 A_SetTranslucent(0.60)
			BANS A 1 A_SetTranslucent(0.70)
			BANS A 1 A_SetTranslucent(0.80)
			BANS A 1 A_SetTranslucent(0.90)
			BANS A 1 A_SetTranslucent(1.0)
			BANS A 0 A_UnSetInvulnerable
			goto See    

		Heal:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			BANS B 8 BRIGHT
			BANS C 8 BRIGHT
			{
				if (levelbehavior > 0 && user_monsterlevel > 120)
				{
					A_CustomMissile("ReviveProj2", 0, 0, 0, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 72, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 144, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 216, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 288, 0);
				}
				else
				if (levelbehavior > 0 && user_monsterlevel > 60)
				{
					A_CustomMissile("ReviveProj2", 0, 0, 0, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 120, 0);
					A_CustomMissile("ReviveProj2", 0, 0, 240, 0);
				}
			}
			BANS D 8 BRIGHT
			Goto See

		Pain:
			BANS A 5 A_GiveInventory("BansheePainToken",5)
			BANS A 5 A_FloatPain(0,6,96)
			BANS A 5 A_JumpIfInventory("BansheePainToken",25,"Missile4")
			Goto See
		Pain.Fist:
			BANS A 5 A_GiveInventory("BansheePainToken",5)
			BANS A 5 A_FloatPain(0,6,96)
			BANS A 5
			BANS A 5 A_JumpIfInventory("BansheePainToken",25,"Missile4")
			Goto See
		Pain.Kick:
			BANS A 5 A_GiveInventory("BansheePainToken",5)
			BANS A 5 A_FloatPain(0,6,96)
			BANS AA 5
			BANS A 5 A_JumpIfInventory("BansheePainToken",25,"Missile4")
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			BANS G 2 A_Scream
			BANS H 2 A_NoBlocking
			BANS I 2 A_CustomMissile("SpawnFire", 0, 0, 0)
			BANS I 2 A_CustomMissile("SpawnFire", 0, 0, 0)
			BANS IJKLMNOPQR 2
			BANS R -1
			Stop
	}
}
actor FBanshee : Banshee
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

actor BansheePainToken : Ammo
{
	Inventory.MaxAmount 50
}

actor BansheeFire3Token : Ammo
{
	Inventory.MaxAmount 50
}

actor BansheeMissile5Token : Ammo
{
	Inventory.MaxAmount 50
}

ACTOR IronlichNew : AetheriusMonsterZSC // replaces Ironlich
{
	Health 700
	Radius 40
	Height 72
	Mass 325
	Speed 6
	Painchance 32
	Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 80 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 4
	Monster
	+NOBLOOD
	+DONTMORPH
	+DONTSQUASH
	+BOSSDEATH
	SeeSound "ironlich/sight"
	AttackSound "ironlich/attack"
	PainSound "ironlich/pain"
	DeathSound "ironlich/death"
	ActiveSound "ironlich/active"
	Obituary "$OB_IRONLICH"
	HitObituary "$OB_IRONLICHHIT"
	DropItem "BlasterAmmo", 84, 10
	DropItem "ArtiEgg", 51, 0

	States
	{
		Spawn:
			LICH A 0 NoDelay 
			LICH A 10 A_Look
			goto Spawn+1
		See:
			LICH A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			LICH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			LICH A 5 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			LICH B 20 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(11); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(12); }
				else if (levelbehavior > 0 && user_monsterlevel > 140) { A_SetTics(13); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(14); }
				else if (levelbehavior > 0 && user_monsterlevel > 100) { A_SetTics(15); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(16); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(17); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(18); }
				else if (levelbehavior > 0 && user_monsterlevel > 20) { A_SetTics(19); }

				A_LichAttack(5+(user_monsterlevel/30), 1+(user_monsterlevel/45), 6*random(1,8), "HeadFX1New", "HeadFX1Crisis", "HeadFX3New", "HeadFX3Crisis", "WhirlwindNew", "WhirlwindCrisis", 1);
			}
			Goto See
		Pain:
			LICH A 4
			LICH A 4 A_Pain
			Goto See
		Pain.Fist:
			LICH A 4
			LICH A 4 A_Pain
			LICH AA 4
			Goto See
		Pain.Kick:
			LICH A 4
			LICH A 4 A_Pain
			LICH AAAA 4
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			LICH C 7
			LICH D 7 A_Scream
			LICH EF 7
			LICH G 7 A_NoBlocking
			LICH H 7 
			LICH I -1 A_BossDeath
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			LICH A 5 A_GenericFreezeDeath
			LICH A 1 A_FreezeDeathChunks
			wait
		Raise:
			LICH H 7 
			LICH GFEDC 7
			goto See
	}
}
actor FIronlich : IronlichNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

// Ice Lich
ACTOR IceLich : AetheriusMonsterZSC
{
	health 700
	painchance 16
	Painchance "Ice", 0 // Ice can't stun Ice Liches
	Painchance "Fist", 24 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 40 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 24 // Fist attacks have a +50% chance of stunning an enemy
	Damagefactor "Ice", 0
	Damagefactor "Fire", 2
	DamageFactor "Crush", 4.0
	speed 6
	radius 40
	height 72
	mass 500
	MONSTER
	+NOGRAVITY
	+NOBLOOD
	+FLOAT
	+MISSILEMORE
	+DONTBLAST
	+DONTMORPH
	+DONTSQUASH
	+NOICEDEATH
	+DONTSPLASH
	+BOSSDEATH
	seesound "ironlich/sight"
	attacksound ""
	painsound "ironlich/pain"
	deathsound "freeze/shatter"
	activesound "ironlich/active"
	obituary "%o was frozen by an Ice Lich"

	states
	{
		Spawn:
			ILCH A 0 NoDelay 
			ILCH A 10 A_Look
			goto Spawn+1
		See:
			LICH A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			ILCH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
				A_SpawnItemEx("IceGuyWisp1", random(-20,20), random(-20,20), random(50,70), 0, 0, 0, 32, 128);
			}
			ILCH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
				A_SpawnItemEx("IceGuyWisp1", random(-20,20), random(-20,20), random(50,70), 0, 0, 0, 32, 128);
			}
			ILCH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			ILCH B 0 bright A_JumpIfCloser(300, "Breath")
			ILCH B 20 bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(11); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(12); }
				else if (levelbehavior > 0 && user_monsterlevel > 140) { A_SetTics(13); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(14); }
				else if (levelbehavior > 0 && user_monsterlevel > 100) { A_SetTics(15); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(16); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(17); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(18); }
				else if (levelbehavior > 0 && user_monsterlevel > 20) { A_SetTics(19); }
				A_FaceTarget;
				A_PlaySoundEx("IceGuyAttack", auto);

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("IceGuyFXNew", "IceGuyFXCrisis", 44, 10, 0, 1);
				A_CrisisSpawnProjectile("IceGuyFXNew", "IceGuyFXCrisis", 44, -10, 0, 1);
			}
			goto See
		Breath:
			ILCH B 0 bright 
			{
				user_shotsfired = 0;
				user_shotsfiredmax = 5 + (user_monsterlevel/45);
			}
		BreathLoop: // 5 times
			ILCH B 0 bright 
			{
				A_PlaySoundEx("FrostBreath", auto);
				A_FaceTarget;
			}
			ILCH BBB 2 bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("IceBreath", "IceBreathCrisis", 20, 0, frandom(-10.0,10.0), CMF_CHECKTARGETDEAD);
			}
			ILCH B 0 
			{
				A_FaceTarget;
				user_shotsfired += 1;
				if (user_shotsfired >= user_shotsfiredmax) { return state("See"); }
				return state("");
			}
			loop

		Pain:
			ILCH A 0 A_Pain
			goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			ILCH A 3 A_Scream
			ILCH A 1 A_IceGuyDie
			stop
	}
}

// Gold Lich
ACTOR Goldlich : IronlichNew 31044
{
	Mass 2000
	Speed 10
	Health 1400
	Painchance 8
	Painchance "Fist", 12 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 20 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 12 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 4.0
	SeeSound "goldlich/sight"
	PainSound "goldlich/pain"
	DeathSound "goldlich/death"
	ActiveSound "goldlich/active"  
	Translation "0:17=112:121", "18:35=137:144", "36:42=116:121", "43:51=137:144", "52:58=114:121", "59:65=137:144"
	Obituary "%o was annihilated by the goldlich's power."
	Species "GoldLich"
	DropItem "BlasterHefty", 84, 50
	DropItem "ArtiEgg", 51, 0

	States
	{
		Spawn:
			LICH A 0 NoDelay 
			LICH A 1 A_Look
			LICH A 3 A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0)
			goto Spawn+1
		See:
			LICH A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			LICH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }

				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
				A_Chase;
			}
			Loop
		Melee:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			LICH A 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
				A_FaceTarget;
			}
			LICH B 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);

				A_LichAttack(5+(user_monsterlevel/20), 1+(user_monsterlevel/30), 8*random(1,8), "HeadFX1New", "HeadFX1Crisis", "HeadFX3New", "HeadFX3Crisis", "WhirlwindNew", "WhirlwindCrisis", 1);
			}
			LICH BBB 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
				A_FaceTarget;
			}
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			LICH A 1 A_FaceTarget
			LICH A 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 0 A_FaceTarget
			LICH B 0 
			{
				A_MonsterCrisisCheck;
				if (random(1,256) <= 85 && CheckClass("Goldlich") == 1 && user_canusecrisisatk == 0) { return state("Missile2"); }
				if (random(1,256) <= 128) { return state("Missile3"); }
				if (random(1,256) <= 255) { return state("Missile4"); }
				return state("");
			}
			Goto See
		Missile2:
			LICH BBBBBBBB 1 A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0)
			TNT1 A 0 A_SpawnItemEx("TeleportFog")
			TNT1 AAAAAAAAAAAAAAAA 0 A_Wander
			TNT1 A 0 
			{
				A_SpawnItemEx("TeleportFog");
				A_UnsetSolid;
				A_SpawnItemEx("FakeGoldlich", 0,0,0, 0,0,0, 0, SXF_TRANSFERTRANSLATION);
			}
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
			TNT1 A 4 
			{
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_SetSolid;
			}
			TNT1 A 0 A_SpawnItemEx("TeleportFog")
			Goto See
		Missile3:
			LICH B 3 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_PlaySound("goldlich/attack2");
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
			LICH B 3 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }

				A_MonsterCrisisCheck;
				for (user_barragecounter = 0; user_barragecounter < 12; user_barragecounter++)
				{
					A_CrisisSpawnProjectile("GoldLichBounce","GoldLichBounceCrisis",32,0,user_barragecounter*30);
				}
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
			LICH B 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
			LICH B 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
			LICH B 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
			Goto See
		Missile4:
			LICH B 3 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_PlaySound("goldlich/attack1");

				user_shotsfired = 0;
				user_shotsfiredmax = 4 + (user_monsterlevel/45);
				if (random (1,2) == 1)
				{
					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("GoldLichFire","GoldLichFireCrisis");
				}
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
			}
			LICH B 1 A_FaceTarget
		Missile4Loop: // 4 times
			LICH B 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("GoldLichFire","GoldLichFireCrisis");
				A_SpawnItemEx("GoldLichGlitter", random(-32,32), random(-32,32), random(8,104),0,0,0, 0,0, 0);
				user_shotsfired += 1;
			}
			LICH B 1 
			{
				A_FaceTarget;
				if (user_shotsfired >= user_shotsfiredmax) { return state("Missile4End"); }
				return state("");
			}
			loop
		Missile4End:
			LICH B 0 
			{
				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("GoldLichFire","GoldLichFireCrisis");
			}
			Goto See

		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			LICH CC 4 A_SpawnItemEx("GoldLichGlitter", random(-36,36), random(-36,36), random(8,104),0,0,0, 0,0, 0)
			LICH D 1 A_Scream
			LICH D 3 A_SpawnItemEx("GoldLichGlitter", random(-36,36), random(-36,36), random(8,104),0,0,0, 0,0, 0)
			LICH D 4 A_SpawnItemEx("GoldLichGlitter", random(-36,36), random(-36,36), random(8,104),0,0,0, 0,0, 0)
			LICH EE 4 A_SpawnItemEx("GoldLichGlitter", random(-40,40), random(-40,40), random(0,112),0,0,0, 0,0, 0)
			LICH FF 4 A_SpawnItemEx("GoldLichGlitter", random(-44,44), random(-44,44), random(0,96),0,0,0, 0,0, 0)
			LICH G 0 A_NoBlocking
			LICH G 4 A_SpawnItemEx("GoldLichGlitter", random(-52,52), random(-52,52), random(0,80),0,0,0, 0,0, 0)
			LICH G 4 A_SpawnItemEx("GoldLichGlitter", random(-52,52), random(-52,52), random(0,80),0,0,0, 0,0, 0)
			LICH HH 4 A_SpawnItemEx("GoldLichGlitter", random(-56,56), random(-56,56), random(0,64),0,0,0, 0,0, 0)
			LICH I 4 A_SpawnItemEx("GoldLichGlitter", random(-64,64), random(-64,64), random(0,48),0,0,0, 0,0, 0)
			LICH I -1 A_BossDeath
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			LICH A 5 A_GenericFreezeDeath
			LICH A 1 A_FreezeDeathChunks
			wait
		Raise:
			LICH H 7 
			LICH GFEDC 7
			goto See
	}
}


ACTOR GoldLichMiniExplodes
{
	+DONTSPLASH
	+NOGRAVITY
	States
	{
		Spawn:
			FXA1 DEF 3 BRIGHT
			Stop
	}
}
ACTOR GoldLichGlitter
{
	+NOGRAVITY
	States
	{
		Spawn:
			GGLT ABCDE 4 BRIGHT
			Stop
	}
}

ACTOR FakeGoldLich : GoldLich
{
	DropItem "BlasterHefty", 255, 50
	Mass 250
	Health 175
	Species "GoldLich"
}

// Blood Lich
ACTOR BloodLich : AetheriusMonsterZSC
{
	Health 2100
	Radius 40
	Height 72
	Mass 2100
	Speed 10
	PainChance 16
	Painchance "Fire", 8 // Fire attacks have a -50% chance of stunning an enemy
	Painchance "Fist", 24 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 40 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 24 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Fire", 0.5
	DamageFactor "Crush", 2.4
	MONSTER
	+NOGRAVITY
	+NOTARGET
	+NOFEAR
	+SPAWNCEILING
	+FLOAT
	+MISSILEMORE
	+MISSILEEVENMORE
	+DONTBLAST
	+DONTMORPH
	+DONTRIP
	+DONTSPLASH
	+BOSS
	+BOSSDEATH
	SeeSound "ironlich/sight"
	AttackSound ""
	PainSound "ironlich/pain"
	DeathSound "ironlich/death"
	ActiveSound "ironlich/active"
	Obituary "%o was reduced to a pile of ash by a Blood Lich."

	States
	{
		Spawn:
			BLCH A 0 NoDelay 
			BLCH A 10 A_Look
			goto Spawn+1
		See:
			BLCH A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			BLCH A 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }

				A_Chase;
			}
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			BLCH B 0 Bright A_JumpIfCloser(300, "Breath")
			BLCH B 0 Bright A_Jump(96,"Curse")
			BLCH B 6 Bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
				A_PlaySoundEx("MageStaffFire", CHAN_AUTO);

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("BloodLichFireball", "BloodLichFireballCrisis", 54, 10, -2, 1);
				A_CrisisSpawnProjectile("BloodLichFireball", "BloodLichFireballCrisis", 54, -10, 2, 1);
			}
			Goto See
		Breath:
			BLCH B 0 bright 
			{
				user_shotsfired = 0;
				user_shotsfiredmax = 5 + (user_monsterlevel/45);
			}
		BreathLoop: // 5
			BLCH B 0 Bright
			{
				A_PlaySoundEx("FlameBreath", CHAN_AUTO);
				A_FaceTarget;
			}
			BLCH BBB 2 Bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(1); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("FireBreath", "FireBreathCrisis", 20, 0, frandom(-3.0,3.0), CMF_CHECKTARGETDEAD);
			}
			BLCH B 0 
			{
				A_FaceTarget;
				user_shotsfired += 1;
				if (user_shotsfired >= user_shotsfiredmax) { return state("See"); }
				return state("");
			}
			loop
		Curse:
			BLCH B 0 Bright A_JumpIfCloser(300, "Breath")
			BLCH B 6 Bright 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("CurseSpell", "CurseSpellCrisis", 20, 0, 0, 1);
			}
			Goto See
		Pain:
			BLCH A 0 A_Pain
			Goto See

		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			TNT1 A 0 
			BLCH C 7 
			{
				if (random(1,256) <= 160) { A_PainDie("HereticImpLeader"); }
			}
			BLCH D 7 A_Scream
			BLCH EF 7
			BLCH G 7 A_NoBlocking
			BLCH H 7
			BLCH I -1 A_BossDeath
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			BLCH A 5 A_GenericFreezeDeath
			BLCH A 1 A_FreezeDeathChunks
			wait
		Raise:
			BLCH H 7 
			BLCH GFEDC 7
			goto See
	}
}

ACTOR ClinkNew : AetheriusMonsterZSC replaces Clink
{
	Health 150
	Radius 20
	Height 64
	Mass 75
	Speed 14
	MeleeRange 52
	Painchance 32
	Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 80 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 6.4
	Monster
	+NOBLOOD
	+FLOORCLIP
	SeeSound "clink/sight"
	AttackSound "clink/attack"
	PainSound "clink/pain"
	DeathSound "clink/death"
	ActiveSound "clink/active"
	Obituary "$OB_CLINK"
	DropItem "SkullRodAmmo", 84, 20	

	States
	{
		Spawn:
			CLNK A 0 NoDelay 
			CLNK AB 10 A_Look
			Loop
		See:
			CLNK A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			CLNK ABCD 3
			{
				if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); }
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }

				if (levelbehavior > 0 && user_monsterlevel > 45) { A_Chase; } else { A_Chase("Melee",""); }
			}
			Loop
		Missile:
			CLNK E 0
			{
				if (levelbehavior > 0 && user_monsterlevel > 90) 
				{
					if (random(1,256) <= 154) { return state("AxeMissile"); } else { return state("LungeAttack"); } 
					return state("See");
				}
				else
				if (levelbehavior > 0 && user_monsterlevel > 45) 
				{
					if (random(1,256) <= 85) { return state("AxeMissile"); } else { return state("LungeAttack"); } 
					return state("See"); 
				}
				return state("See");
			}
			goto See

		AxeMissile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			CLNK EF 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			CLNK G 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("ClinkAxe","ClinkAxeCrisis", 30, random[ClinkAttack](3,9), "clink/attack");
			}
			Goto See

		LungeAttack:
			CLNK A 0 A_JumpIfCloser(208,1)
			Goto AxeMissile
			CLNK A 0 A_Jump(64, "AxeMissile")
			CLNK P 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			CLNK P 0
			{
				if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) < 1) { A_GiveInventory("ClinkLungeAttackStatus",1); }
				A_FaceTarget;
			}
			CLNK Q 1 ThrustThingZ(0,40,0,1)
			CLNK Q 0 A_SpawnItemEx("SabreclawGhostTrail",0,0,0,0,0,0,0,128,0)
			CLNK E 0 A_FaceTarget
			CLNK Q 0 A_Recoil (-10)
			CLNK QQQQ 1 A_JumpIfCloser(71, "MeleeStrike")
			CLNK Q 0 A_SpawnItemEx("SabreclawGhostTrail",0,0,0,0,0,0,0,128,0)
			CLNK QQQQ 1 A_JumpIfCloser(71, "MeleeStrike")
			CLNK Q 0 A_SpawnItemEx("SabreclawGhostTrail",0,0,0,0,0,0,0,128,0)
			CLNK QQQQ 1 A_JumpIfCloser(71, "MeleeStrike")
			CLNK Q 0 A_SpawnItemEx("SabreclawGhostTrail",0,0,0,0,0,0,0,128,0)
			CLNK QQQP 1 A_JumpIfCloser(71, "MeleeStrike")
			CLNK P 0 A_SpawnItemEx("SabreclawGhostTrail2",0,0,0,0,0,0,0,128,0)
			CLNK PPPP 1 A_JumpIfCloser(71, "MeleeStrike")
			CLNK P 0 A_SpawnItemEx("SabreclawGhostTrail2",0,0,0,0,0,0,0,128,0)
			CLNK P 1 A_JumpIfCloser(71, "MeleeStrike")
			Goto See
		MeleeStrike:
			CLNK G 0 A_FaceTarget
			CLNK G 7
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }
				if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random(6,18), "clink/attack", "clink/attack", "Melee", 1);
			}
			Goto See

		Melee:
			TNT1 A 0 
			{
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
				if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); }
			}
			CLNK E 5 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			CLNK F 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_FaceTarget;
			}
			CLNK G 7 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }

				A_MonsterCrisisCheck;
				A_CrisisMeleeAttack(random[ClinkAttack](3,9), "clink/attack", "clink/attack");
			}
			Goto See
		Pain:
			CLNK H 3 { if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); } }
			CLNK H 3 A_Pain
			Goto See
		Pain.Fist:
			CLNK H 3 { if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); } }
			CLNK H 3 A_Pain
			CLNK HH 3 
			Goto See
		Pain.Kick:
			CLNK H 3 { if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); } }
			CLNK H 3 A_Pain
			CLNK HHHH 3 
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			CLNK IJ 6
			{
				if (CountInv("ClinkLungeAttackStatus",AAPTR_DEFAULT) > 0) { A_TakeInventory("ClinkLungeAttackStatus",0x7FFFFFFF); }
			}
			CLNK K 5 A_Scream
			CLNK L 5 A_NoBlocking
			CLNK MN 5 
			CLNK O -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			CLNK H 5 A_GenericFreezeDeath
			CLNK H 1 A_FreezeDeathChunks
			wait
		Raise:
			CLNK N 5 
			CLNK MLKJI 5
			goto See
	}
}
actor FClink : ClinkNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

ACTOR SabreclawGhostTrail //: AetheriusProjectileZSC
{
	Radius 16
	Height 56
	Speed 1
	Damage 0
	RenderStyle Translucent
	Alpha 0.7
	PROJECTILE
	+CLIENTSIDEONLY
	states
	{
		Spawn:
			CLNK Q 0
			CLNK Q 1 A_FadeOut(0.10)
			goto Spawn+1
	}
}

ACTOR SabreclawGhostTrail2 //: AetheriusProjectileZSC
{
	Radius 16
	Height 56
	Speed 1
	Damage 0
	RenderStyle Translucent
	Alpha 0.7
	PROJECTILE
	+CLIENTSIDEONLY
	states
	{
		Spawn:
			CLNK P 0
			CLNK P 1 A_FadeOut(0.10)
			goto Spawn+1
	}
}

// Makes the SabreClaw more 50% more vulnerable to melee-type attacks when lunging at something :V
actor ClinkLungeAttackStatus : PowerProtection 
{ 
	Damagefactor "Melee", 1.5 
	DamageFactor "Sceptre", 1.5
	Damagefactor "Fist", 1.5
	Damagefactor "Kick", 1.5
	Damagefactor "Gauntlets", 1.5
	Damagefactor "Chainsaw", 1.5
	DamageFactor "Stomp", 1.5
	DamageFactor "Trample", 1.5
	inventory.icon "" 
}

ACTOR BeastNew : AetheriusMonsterZSC // replaces Beast
{
	Health 220
	Radius 32
	Height 74
	Mass 200
	Speed 14
	Painchance 100
	Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 6.4
	Monster
	+FLOORCLIP
	SeeSound "beast/sight"
	AttackSound "beast/attack"
	PainSound "beast/pain"
	DeathSound "beast/death"
	ActiveSound "beast/active"
	Obituary "$OB_BEAST"
	DropItem "CrossbowAmmo", 84, 10

	States
	{
		Spawn:
			BEAS A 0 NoDelay 
			BEAS AB 10 A_Look
			goto Spawn+1
		See:
			BEAS A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			BEAS ABCDEF 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			BEAS H 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			BEAS I 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }

				A_MonsterCrisisCheck;
				A_CrisisComboAttack("BeastBallNew", "BeastBallCrisis", 32, random[BeastAttack](1,8)*3, "beast/attack");
			}
			Goto See
		Pain:
			BEAS G 3
			BEAS G 3 A_Pain
			Goto See
		Pain.Fist:
			BEAS G 3
			BEAS G 3 A_Pain
			BEAS GG 3
			Goto See
		Pain.Kick:
			BEAS G 3
			BEAS G 3 A_Pain
			BEAS GGGG 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			BEAS R 6
			BEAS S 6 A_Scream
			BEAS TUV 6
			BEAS W 6 A_NoBlocking
			BEAS XY 6 
			BEAS Z -1
			Stop
		XDeath:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			BEAS J 5
			BEAS K 6 A_Scream
			BEAS L 5
			BEAS M 6
			BEAS N 5
			BEAS O 6 A_NoBlocking
			BEAS P 5
			BEAS Q -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			BEAS G 5 A_GenericFreezeDeath
			BEAS G 1 A_FreezeDeathChunks
			wait
		Raise:
			BEAS P 5 
			BEAS O 6 
			BEAS N 5 
			BEAS M 6 
			BEAS L 5 
			BEAS K 6 
			BEAS J 5 
			goto See
	}
}
actor FBeast : BeastNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

ACTOR ShadowBeast : AetheriusMonsterZSC 30123
{
	OBITUARY "%o was killed by a shadow beast."
	Bloodcolor "70 AC 00"
	Health 750 // 500
	Radius 40
	Height 80
	Mass 1250 // 500
	Speed 12
	PainChance 144
	Painchance "Fist", 216 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 256 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 216 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 6.4
	Alpha 1.0
	RenderStyle Translucent
	SEESOUND "shadowbeast/sight"
	PAINSOUND "shadowbeast/pain"
	DEATHSOUND "shadowbeast/death"
	ACTIVESOUND "shadowbeast/active"
	MONSTER
	+FloorClip
	states
	{
		Spawn:
			BDEM AB 10 A_Look
			Loop
		See:
			TNT1 A 0 A_JumpIfHealthLower ((user_MaxHP/2), "Run") 
			BDEM ABCDEF 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); A_ChangeFlag("AVOIDMELEE",1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); A_ChangeFlag("AVOIDMELEE",1); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); A_ChangeFlag("AVOIDMELEE",1); }
				A_Chase;
			}
			Loop
		Run:
			TNT1 A 0 A_PlaySound("shadowbeast/sight")
			BDEM AABBCCDDEEFFAABBCCDDEEFFAABBCCDDEEFF 3 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_Chase("","");
			}
			TNT1 A 0 A_Jump(252, "Missile")
			Goto See

		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			TNT1 A 0 A_JumpIfHealthLower ((user_MaxHP/2), "Missile2") 
			TNT1 A 0 A_Jump(90, "Attack1b")

			Attack1a:
				BDEM H 6 
				{
					if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
					else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
					A_FaceTarget;
				}
				BDEM I 6 
				{
					if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
					else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall1", "ShadowBeastBall1Crisis", 56, 0, -8);
					A_CrisisSpawnProjectile("ShadowBeastBall1", "ShadowBeastBall1Crisis", 56, 0, 0);
					A_CrisisSpawnProjectile("ShadowBeastBall1", "ShadowBeastBall1Crisis", 56, 0, 8);
				}
				Goto See
			Attack1b:
				BDEM H 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, -16);
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, -8);
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, 0);
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, 8);
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, 16);
				}
				BDEM I 4 
				{
					if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
					else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
					A_FaceTarget;

					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("ShadowBeastBall2", "ShadowBeastBall2Crisis", 56, 0, 32);
				}
				Goto See

		Missile2:
			TNT1 A 0 A_Jump(90, "Attack2b")
		Attack2a:
			BDEM H 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			BDEM IIIIIIIIIIIII 2 
			{
				if (levelbehavior > 0 && user_monsterlevel > 300) { A_SetTics(1); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("ShadowBeastBallFire", "ShadowBeastBallFireCrisis", 56, 0, random(-8,8));
			}
			Goto See
		Attack2b:
			BDEM H 16 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 157) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 135) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 112) { A_SetTics(11); }
				else if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(12); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(13); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(14); }
				else if (levelbehavior > 0 && user_monsterlevel > 22) { A_SetTics(15); }
				A_FaceTarget;
			}
			BDEM I 6 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -64);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 64);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -56);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 56);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -48);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 48);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -40);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 40);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -32);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 32);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -24);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 24);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -16);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 16);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, -8);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 8);
				A_CrisisSpawnProjectile("ShadowBeastBall3", "ShadowBeastBall3Crisis", 56, 0, 0);
			}
			Goto See

		Pain:
			TNT1 A 0 A_Jump ((16+(user_monsterlevel/4)), "Spread")
			BDEM G 2
			BDEM G 4 A_Pain
			Goto See
		Pain.Fist:
			TNT1 A 0 A_Jump ((16+(user_monsterlevel/16)), "Spread")
			BDEM G 2
			BDEM G 4 A_Pain
			BDEM GG 4
			Goto See
		Pain.Kick:
			TNT1 A 0 A_Jump ((16+(user_monsterlevel/32)), "Spread")
			BDEM G 2
			BDEM G 4 A_Pain
			BDEM GGGG 4
			Goto See

		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			BDEM R 8
			BDEM S 8 A_Scream
			BDEM TUVWX 6
			BDEM Y 6 A_NoBlocking
			BDEM Z -1
			Stop
		Raise:
			BEAS Y 6 
			BEAS XWVUT 6 
			BEAS SR 8 
			goto See

		Spread:
			TNT1 A 0 
			{
				A_SpawnItemEx ("ShadowBeastSpread", 0, 0, 0, 0, 0, 0, 0, 128);

				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);
				A_SpawnItemEx ("ShadowBeastSparkle", random(0,16), random(0,16), random(16,48), 0, 0, 0, random(0,359), 128);

				A_MonsterCrisisCheck;
				A_CrisisSpawnItemEx("ShadowBeastCreature", "ShadowBeastCreatureCrisis", 0, 0, random(16,48), random(0,8), random(0,8), random(0,8), random(0,359), 0);
				A_CrisisSpawnItemEx("ShadowBeastCreature", "ShadowBeastCreatureCrisis", 0, 0, random(16,48), random(0,8), random(0,8), random(0,8), random(0,359), 0);
				A_CrisisSpawnItemEx("ShadowBeastCreature", "ShadowBeastCreatureCrisis", 0, 0, random(16,48), random(0,8), random(0,8), random(0,8), random(0,359), 0);
				A_CrisisSpawnItemEx("ShadowBeastCreature", "ShadowBeastCreatureCrisis", 0, 0, random(16,48), random(0,8), random(0,8), random(0,8), random(0,359), 0);
				A_CrisisSpawnItemEx("ShadowBeastCreature", "ShadowBeastCreatureCrisis", 0, 0, random(16,48), random(0,8), random(0,8), random(0,8), random(0,359), 0);
				
				A_SetTranslucent(0.0);
			}
			Goto Wander
		Wander:
			TNT1 A 0 
			{
				A_UnSetShootable;
				A_ChangeFlag("NOPAIN", 1);
			}
			TNT1 A 0 A_Jump(60, 5)
			TNT1 A 0 A_Jump(60, 15)
			TNT1 A 0 A_Jump(60, 25)
			TNT1 A 0 A_Jump(60, 35)
			TNT1 A 0 A_Jump(60, 45)
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 2 
			{
				if (levelbehavior > 0 && user_monsterlevel > 300) { A_SetTics(1); }
				A_Wander;
			}
			BDEM ABCDEF 3 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(1); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				A_FadeIn(0.1667,FTF_CLAMP);
				if (random(1,6) == 1) { A_Wander; } else { A_Chase("",""); }
			}
			TNT1 A 0 
			{
				A_SetShootable;
				A_ChangeFlag("NOPAIN", 0);
			}
			Goto See
	}
}

ACTOR ShadowBeastSpread //: AetheriusProjectileZSC
{
	Radius 1
	Height 1
	Damage 0
	Speed 0
	PROJECTILE
	states
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_PlaySound ("shadowbeast/spread")
			BDEM JKLMNOP 8
			BDEM Q 70 
			BDEM QQQQQQQQQQ 1 A_FadeOut(0.1)
			stop
	}
}

ACTOR ShadowBeastCreature
{
	Alpha 1.0
	Renderstyle Add
	Speed 16
	MONSTER
	-SOLID
	-SHOOTABLE
	-COUNTKILL
	+FLOAT
	+NOGRAVITY
	states
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Playsound("shadowbeast/spiritsit")
			Goto See
		See:
			TNT1 A 0 A_Jump(60, 5)
			TNT1 A 0 A_Jump(60, 15)
			TNT1 A 0 A_Jump(60, 25)
			TNT1 A 0 A_Jump(60, 35)
			TNT1 A 0 A_Jump(60, 45)
			BDSP ABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABAB 2 A_Chase
			Goto Death  
		Melee:
			BDSP AB 2 A_CustomMeleeAttack((5 * random(1,8)), "", "", "Magic")
			Goto See
		Death:
			TNT1 A 0 A_Playsound("shadowbeast/spiritdth")
			BDSP EFGHIJ 5
			Stop
	}
}
ACTOR ShadowBeastCreatureCrisis : ShadowBeastCreature
{
	Alpha 1.0
	Renderstyle Add
	Speed 16
	MONSTER
	-SOLID
	-SHOOTABLE
	-COUNTKILL
	+FLOAT
	+NOGRAVITY
	states
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Playsound("shadowbeast/spiritsit")
			Goto See
		See:
			TNT1 A 0 A_Jump(60, 5)
			TNT1 A 0 A_Jump(60, 15)
			TNT1 A 0 A_Jump(60, 25)
			TNT1 A 0 A_Jump(60, 35)
			TNT1 A 0 A_Jump(60, 45)
			BDSP ABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABAB 2 A_Chase
			Goto Death  
		Melee:
			BDSP AB 2 A_CustomMeleeAttack((5 * random(1,8) * CallACS("CrisisMultiplier")), "", "", "Magic")
			Goto See
		Death:
			TNT1 A 0 A_Playsound("shadowbeast/spiritdth")
			BDSP EFGHIJ 5
			Stop
	}
}

ACTOR MaulotaurNew : MaulotaurBase replaces Minotaur
{
	Health 3000
	Radius 28
	Height 100
	Mass 800
	Speed 16
	Damage 7
	Painchance 25
	Painchance "Fist", 38 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 63 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 38 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "GravityHP", 85
	Painchance "GravityMP", 85
	Painchance "GravityHPMP", 85 
	DamageFactor "Crush", 2.4
	Monster
	+DROPOFF
	+FLOORCLIP
	+BOSS
	+NORADIUSDMG
	+DONTMORPH
	+NOTARGET
	+BOSSDEATH
	+AVOIDMELEE
	SeeSound "minotaur/sight"
	AttackSound "minotaur/attack1"
	PainSound "minotaur/pain"
	DeathSound "minotaur/death"
	ActiveSound "minotaur/active"
	DropItem "ArtiSuperHealth", 51
	DropItem "PhoenixRodAmmo", 84, 10
	DropItem "PhoenixRodHefty", 84
	DropItem "ArtiSuperHealth", 51

	States
	{
		Spawn:
			MNTR A 0 NoDelay 
			MNTR AB 10 A_MinotaurLook
			goto Spawn+1
		Roam:
			MNTR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MNTR ABCD 5
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(4); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(3); }
				A_MinotaurRoam;
			}
			Loop
		See:
			MNTR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			MNTR ABCD 5 
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(4); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(3); }
				A_MinotaurChase;
			}
			Loop
		Melee:
			TNT1 A 0 
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			MNTR V 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			MNTR W 7
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget;
			}
			MNTR X 12 
			{
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 23) { A_SetTics(11); }
				A_MinotaurAtk1(4*random(1,8), -16);
			}
			Goto See
		Missile:
			TNT1 A 0 
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			MNTR V 10
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				if (random(1,256) <= 170) { A_MinotaurDecide; }
			}
			MNTR Y 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }
				A_FaceTarget;
			}
			MNTR Z 9 
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(8); }
				A_MinotaurAtk2("MinotaurFX1","MinotaurFX1Crisis",5*random(1,8),3*random(1,8));
			}
			Goto See
		Hammer:
			TNT1 A 0 
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			MNTR V 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			MNTR W 7
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget;
			}
			MNTR X 12 
			{
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 23) { A_SetTics(11); }
				A_MinotaurAtk3(4*random(1,8), -16, "MinotaurFX2New", "MinotaurFX2Crisis");
			}
			Goto See
		HammerLoop:
			TNT1 A 0 
			{
				A_TakeInventory("MaulotaurChargeDefense",0x7FFFFFFF);
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			MNTR X 12
			{
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 67) { A_SetTics(9); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 23) { A_SetTics(11); }
			}
			Goto Hammer
		Charge:
			TNT1 A 0 
			{
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
				SetDamage(7+(user_monsterlevel/45));
				A_MonsterCrisisCheck;
				if(user_canusecrisisatk == 1) 
				{
					A_PlayCrisisAtkSound;
					SetDamage((7+(user_monsterlevel/45))*CallACS("CrisisMultiplier"));
				}
			}
			MNTR U 2 A_MinotaurCharge
			Loop
		Pain:
			MNTR E 3
			MNTR E 6 A_Pain
			Goto See
		Pain.Fist:
			MNTR E 3
			MNTR E 6 A_Pain
			MNTR EE 3
			Goto See
		Pain.Kick:
			MNTR E 3
			MNTR E 6 A_Pain
			MNTR EEEE 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			MNTR F 6 A_MinotaurDeath
			MNTR G 5
			MNTR H 6 A_Scream
			MNTR I 5
			MNTR J 6
			MNTR K 5
			MNTR L 6
			MNTR M 5 A_NoBlocking
			MNTR N 6
			MNTR O 5
			MNTR P 6
			MNTR Q 5
			MNTR R 6
			MNTR S 5 
			MNTR T -1 A_BossDeath
			Stop
		FadeOut:
			MNTR E 6
			MNTR E 2 A_Scream
			MNTR E 5 A_SpawnItemEx("MinotaurSmokeExit")
			MNTR E 5
			MNTR E 5 A_NoBlocking
			MNTR E 5
			MNTR E 5 A_SetTranslucent(0.66, 0)
			MNTR E 5 A_SetTranslucent(0.33, 0)
			MNTR E 0 
			MNTR E 10 A_BossDeath
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			MNTR E 5 A_GenericFreezeDeath
			MNTR E 1 A_FreezeDeathChunks
			wait
		Raise:
			MNTR S 5 
			MNTR R 6 
			MNTR Q 5 
			MNTR P 6 
			MNTR O 5 
			MNTR N 6 
			MNTR M 5 
			MNTR L 6 
			MNTR K 5 
			MNTR J 6 
			MNTR I 5 
			MNTR H 6 
			MNTR G 5 
			MNTR F 6 
			goto See
	}
}
actor FMaulotaur : MaulotaurNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

ACTOR SnakeNew : AetheriusMonsterZSC // replaces Snake
{
	Health 280
	Radius 22
	Height 70
	Speed 10
	Painchance 48
	Painchance "Fist", 72 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 120 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 72 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 6.4
	Monster
	+FLOORCLIP
	+DONTHARMSPECIES
	AttackSound "snake/attack"
	SeeSound "snake/sight"
	PainSound "snake/pain"
	DeathSound "snake/death"
	ActiveSound "snake/active"
	Obituary "$OB_SNAKE"
	DropItem "PhoenixRodAmmoNew", 84
	DropItem "PhoenixRodAmmoNew", 84
	DropItem "PhoenixRodAmmoNew", 84
	DropItem "PhoenixRodAmmoNew", 84
	DropItem "PhoenixRodAmmoNew", 84
	Species "Ophidian"

	States
	{
		Spawn:
			SNKE A 0 NoDelay 
			SNKE AB 10 A_Look
			goto Spawn+1
		See:
			SNKE A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			SNKE ABCD 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Chase;
			}
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			SNKE FF 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			SNKE FFF 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("SnakeProjANew", "SnakeProjACrisis", 32, 0, 0, CMF_CHECKTARGETDEAD);
			}
			SNKE FFF 5
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(4); }
				A_FaceTarget;
			}
			SNKE F 4 
			{
				if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("SnakeProjBNew", "SnakeProjBCrisis", 32, 0, 0, CMF_CHECKTARGETDEAD);
			}
			Goto See
		Pain:
			SNKE E 3
			SNKE E 3 A_Pain
			Goto See
		Pain.Fist:
			SNKE E 3
			SNKE E 3 A_Pain
			SNKE EE 3
			Goto See
		Pain.Kick:
			SNKE E 3
			SNKE E 3 A_Pain
			SNKE EEEE 3
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			SNKE G 5
			SNKE H 5 A_Scream
			SNKE IJKL 5
			SNKE M 5 A_NoBlocking
			SNKE NO 5 
			SNKE P -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			SNKE E 5 A_GenericFreezeDeath
			SNKE E 1 A_FreezeDeathChunks
			wait
		Raise:
			SNKE P 5 
			SNKE ONMLKJIHG 5 
			goto See
	}
}
actor FSnake : SnakeNew
{
	-COUNTKILL 
	+FRIENDLY +THRUSPECIES +DONTHARMSPECIES
	Species "FriendlyMonsters"
	dropitem NoItemSpawn 1
}

// Hell Guard
actor HellGuard : AetheriusMonsterZSC 3114
{
	//$Category "ZDoom Monster pack"
	Health 420 // 300
	Radius 24
	Height 64
	Speed 12 // 8
	PainChance 50
	Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Crush", 6.4
	Mass 750 // 500
	MONSTER 
	+FLOORCLIP
	SeeSound "hellguard/sight"
	PainSound "hellguard/pain"
	DeathSound "hellguard/death"
	ActiveSound "hellguard/idle"
	Obituary "%o was fried to cinders by an abyssal guard."
	MeleeDamage 12 // 8
	Species "Ophidian"
	Species "HellNoble"
	+DONTHARMSPECIES
	DropItem "PhoenixRodAmmo", 132, 5

	States
	{
		Spawn:
			HLGD A 0 NoDelay 
			HLGD AB 10 A_Look
			goto Spawn+1
		See:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			HLGD AABBCCDD 3
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(2); }
				A_Chase;
			}
			Loop
		Missile:
			TNT1 A 0
			{
				ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
			}
			HLGD E 8 
			{
				if (levelbehavior > 0 && user_monsterlevel > 240) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(7); }
				A_FaceTarget;
			}
			HLGD F 4 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("HellGuardBall", "HellGuardBallCrisis", 28, -8, (frandom(-4.0,4.0)*2.0), CMF_OFFSETPITCH|CMF_BADPITCH, frandom(-3.0,3.0));
			}
			HLGD E 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_FaceTarget; } else { A_SetTics(0); }
			}
			HLGD F 4 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				if (levelbehavior > 0 && user_monsterlevel > 120) 
				{
					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("HellGuardBall", "HellGuardBallCrisis", 28, -8, (frandom(-4.0,4.0)*2.0), CMF_OFFSETPITCH|CMF_BADPITCH, frandom(-3.0,3.0));
				}
				else 
				{
					A_SetTics(0); 
				}
			}
			HLGD E 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_FaceTarget;
			}
			HLGD F 4 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("HellGuardBall", "HellGuardBallCrisis", 28, -8, (frandom(-4.0,4.0)*2.0), CMF_OFFSETPITCH|CMF_BADPITCH, frandom(-3.0,3.0));
			}
			HLGD E 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_FaceTarget; } else { A_SetTics(0); }
			}
			HLGD F 4 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				if (levelbehavior > 0 && user_monsterlevel > 120) 
				{
					A_MonsterCrisisCheck;
					A_CrisisSpawnProjectile("HellGuardBall", "HellGuardBallCrisis", 28, -8, (frandom(-4.0,4.0)*2.0), CMF_OFFSETPITCH|CMF_BADPITCH, frandom(-3.0,3.0));
				}
				else 
				{
					A_SetTics(0); 
				}
			}
			HLGD E 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }
				A_FaceTarget;
			}
			HLGD F 4 Bright
			{
				if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(2); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(3); }

				A_MonsterCrisisCheck;
				A_CrisisSpawnProjectile("HellGuardBall", "HellGuardBallCrisis", 28, -8, (frandom(-4.0,4.0)*2.0), CMF_OFFSETPITCH|CMF_BADPITCH, frandom(-3.0,3.0));
			}
			Goto See
		Pain:
			HLGD G 2
			HLGD G 2 A_Pain
			Goto See
		Pain.Fist:
			HLGD G 2
			HLGD G 2 A_Pain
			HLGD GG 2
			Goto See
		Pain.Kick:
			HLGD G 2
			HLGD G 2 A_Pain
			HLGD GGGG 2
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			HLGD H 6
			HLGD I 6 A_Scream
			HLGD J 6
			HLGD K 6 A_Fall
			HLGD L 6
			HLGD M 6 
			HLGD N -1
			Stop
		Ice:
			"####" # 0 A_DVDSIceDeath(-2,0,1)
			HLGD G 5 A_GenericFreezeDeath
			HLGD G 1 A_FreezeDeathChunks
			wait
		Raise:
			HLGD O 8 
			HLGD NMLKJI 8
			Goto See
	}
}

ACTOR DSparilMountedNew : DSparilBase replaces Sorcerer1
{
	Health 24000
	Radius 28
	Height 100
	Mass 800
	Speed 16
	Painchance 56
	Painchance "Fist", 84 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 140 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 84 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "GravityHP", 1
	Painchance "GravityMP", 1
	Painchance "GravityHPMP", 1 
	DamageFactor "Crush", 0.5
	Monster
	+BOSS
	+DONTMORPH
	+NORADIUSDMG
	+NOTARGET
	+NOICEDEATH
	+FLOORCLIP
	+DONTGIB
	+AVOIDMELEE
	SeeSound "dsparilserpent/sight"
	AttackSound "dsparilserpent/attack"
	PainSound "dsparilserpent/pain"
	DeathSound "dsparilserpent/death"
	ActiveSound "dsparilserpent/active"
	Obituary "$OB_DSPARIL1"
	HitObituary "$OB_DSPARIL1HIT"

	States
	{
		Pain.Charm: Goto See
		Spawn:
			SRCR A 0 NoDelay 
			SRCR AB 10 A_Look
			goto Spawn+1
		See:
			SRCR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			SRCR ABCD 5 
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (levelbehavior > 0 && user_monsterlevel > 90) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 45) { A_SetTics(4); }
				A_Sor1Chase;
			}
			Loop
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			SRCR Q 7 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget;
			}
			SRCR R 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			SRCR S 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_Srcr1Attack(8*random(1,8), "SorcererFX1New", "SorcererFX1Crisis");
			}
			Goto See
		Missile2:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			SRCR S 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_FaceTarget;
			}
			SRCR Q 7 
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(6); }
				A_FaceTarget;
			}
			SRCR R 6
			{
				if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(3); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(4); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			SRCR S 10 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(8); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(9); }
				A_Srcr1Attack(8*random(1,8), "SorcererFX1New", "SorcererFX1Crisis");
			}
			Goto See
		Pain:
			SRCR Q 6 A_Sor1Pain
			Goto See
		Pain.Fist:
			SRCR Q 6 A_Sor1Pain
			SRCR Q 6
			Goto See
		Pain.Kick:
			SRCR Q 6 A_Sor1Pain
			SRCR QQ 6
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			SRCR E 7
			SRCR F 7 A_Scream
			SRCR G 7
			SRCR HIJK 6 
			SRCR L 25 A_PlaySound("dsparil/zap", CHAN_BODY, 1, FALSE, ATTN_NONE)
			SRCR MN 5
			SRCR O 4
			SRCR L 20 A_PlaySound("dsparil/zap", CHAN_BODY, 1, FALSE, ATTN_NONE)
			SRCR MN 5
			SRCR O 4
			SRCR L 12
			SRCR P -1 A_SorcererRise
		Ice:
			goto Death
	}
}

ACTOR DSparilUnmountedNew : DSparilBase replaces Sorcerer2
{
	Health 56000
	Radius 16
	Height 70
	Mass 300
	Speed 14
	Painchance 32
	Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 80 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "GravityHP", 1
	Painchance "GravityMP", 1
	Painchance "GravityHPMP", 1 
	DamageFactor "Crush", 0.5
	Monster
	+DROPOFF
	+BOSS
	+DONTMORPH
	+FULLVOLACTIVE
	+NORADIUSDMG
	+NOTARGET
	+NOICEDEATH
	+FLOORCLIP
	+BOSSDEATH
	+AVOIDMELEE
	SeeSound "dsparil/sight"
	AttackSound "dsparil/attack"
	PainSound "dsparil/pain"
	ActiveSound "dsparil/active"
	Obituary "$OB_DSPARIL2"
	HitObituary "$OB_DSPARIL2HIT"

	States
	{
		Pain.Charm: Goto See
		Spawn:
			SOR2 A 0 NoDelay 
			SOR2 MN 10 A_Look
			goto Spawn+1
		See:
			SOR2 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
			SOR2 MNOP 4
			{
				if (levelbehavior > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); A_SetTics(3); }
				A_Sor2Chase;
			}
			Loop
		Rise:
			SOR2 A 0 
			SOR2 A 0 
			SOR2 AB 4
			SOR2 C 4 A_PlaySound("dsparil/rise", CHAN_BODY, 1, FALSE, ATTN_NONE)
			SOR2 DEF 4
			SOR2 G 12 A_PlaySound("dsparil/sight", CHAN_BODY, 1, FALSE, ATTN_NONE)
			Goto See
		Pain:
			SOR2 Q 3
			SOR2 Q 6 A_Sor2Pain
			Goto See
		Pain.Fist:
			SOR2 Q 3
			SOR2 Q 6 A_Sor2Pain
			SOR2 Q 3
			Goto See
		Pain.Kick:
			SOR2 Q 3
			SOR2 Q 6 A_Sor2Pain
			SOR2 QQ 3
			Goto See
		Missile:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
			SOR2 R 9 
			{
				if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(8); }
				A_Srcr2Decide;
			}
			SOR2 S 9 
			{
				if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(5); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(6); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(7); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(8); }
				A_FaceTarget;
			}
			SOR2 T 20 
			{
				if (levelbehavior > 0 && user_monsterlevel > 200) { A_SetTics(10); }
				else if (levelbehavior > 0 && user_monsterlevel > 180) { A_SetTics(11); }
				else if (levelbehavior > 0 && user_monsterlevel > 160) { A_SetTics(12); }
				else if (levelbehavior > 0 && user_monsterlevel > 140) { A_SetTics(13); }
				else if (levelbehavior > 0 && user_monsterlevel > 120) { A_SetTics(14); }
				else if (levelbehavior > 0 && user_monsterlevel > 100) { A_SetTics(15); }
				else if (levelbehavior > 0 && user_monsterlevel > 80) { A_SetTics(16); }
				else if (levelbehavior > 0 && user_monsterlevel > 60) { A_SetTics(17); }
				else if (levelbehavior > 0 && user_monsterlevel > 40) { A_SetTics(18); }
				else if (levelbehavior > 0 && user_monsterlevel > 20) { A_SetTics(19); }
				A_Srcr2Attack(20*random(1,8),"Sorcerer2FX1New","Sorcerer2FX1Crisis","Sorcerer2FX2New","Sorcerer2FX2Crisis");
			}
			Goto See
		Teleport:
			TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0) // makes sure D'Sparil is as stealth as possible when proceeding to teleport if flagged as stealth
			SOR2 LKJIHG 6
			Goto See
		Death:
			TNT1 A 0 ACS_NamedExecuteWithResult("AddEXP",-2,0,1)
			SDTH A 8 A_Sor2DthInit
			SDTH B 8
			SDTH C 8 A_PlaySound("dsparil/scream", CHAN_BODY, 1, FALSE, ATTN_NONE)
		DeathLoop:
			SDTH DE 7
			SDTH F 7 A_Sor2DthLoop
			SDTH G 6 A_PlaySound("dsparil/explode", CHAN_BODY, 1, FALSE, ATTN_NONE)
			SDTH H 6 A_SpawnItemEx("DSparilStaff",0,0,0,random(-12,12),random(-12,12),random(-12,12))
			SDTH I 18
			SDTH J 6 A_NoBlocking
			SDTH K 6 A_PlaySound("dsparil/bones", CHAN_BODY, 1, FALSE, ATTN_NONE)
			SDTH LMN 6 
			SDTH O -1 A_BossDeath
			Stop
		Ice:
			goto Death
	}
}